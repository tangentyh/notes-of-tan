<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Java Basics | Notes of Tan</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="https://v1.vuepress.vuejs.org/hero.png">
    <meta name="description" content="Tan's notes.">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/notes-of-tan/assets/css/0.styles.9802d8bc.css" as="style"><link rel="preload" href="/notes-of-tan/assets/js/app.34e04cb3.js" as="script"><link rel="preload" href="/notes-of-tan/assets/js/2.33f31c9b.js" as="script"><link rel="preload" href="/notes-of-tan/assets/js/22.391b670c.js" as="script"><link rel="prefetch" href="/notes-of-tan/assets/js/10.0548b82b.js"><link rel="prefetch" href="/notes-of-tan/assets/js/11.95d04f86.js"><link rel="prefetch" href="/notes-of-tan/assets/js/12.ef1d3621.js"><link rel="prefetch" href="/notes-of-tan/assets/js/13.a4adee88.js"><link rel="prefetch" href="/notes-of-tan/assets/js/14.c09755c2.js"><link rel="prefetch" href="/notes-of-tan/assets/js/15.6b5434aa.js"><link rel="prefetch" href="/notes-of-tan/assets/js/16.d58a8b76.js"><link rel="prefetch" href="/notes-of-tan/assets/js/17.396500f6.js"><link rel="prefetch" href="/notes-of-tan/assets/js/18.0f6112b9.js"><link rel="prefetch" href="/notes-of-tan/assets/js/19.c704f56e.js"><link rel="prefetch" href="/notes-of-tan/assets/js/20.3db6e29e.js"><link rel="prefetch" href="/notes-of-tan/assets/js/21.5ada412e.js"><link rel="prefetch" href="/notes-of-tan/assets/js/23.49e69635.js"><link rel="prefetch" href="/notes-of-tan/assets/js/24.1ec9070f.js"><link rel="prefetch" href="/notes-of-tan/assets/js/25.c9b3cb0c.js"><link rel="prefetch" href="/notes-of-tan/assets/js/26.6d0133c7.js"><link rel="prefetch" href="/notes-of-tan/assets/js/27.93996405.js"><link rel="prefetch" href="/notes-of-tan/assets/js/28.505ceb00.js"><link rel="prefetch" href="/notes-of-tan/assets/js/29.9de9cb08.js"><link rel="prefetch" href="/notes-of-tan/assets/js/3.f2118d7b.js"><link rel="prefetch" href="/notes-of-tan/assets/js/30.1574681b.js"><link rel="prefetch" href="/notes-of-tan/assets/js/31.97ed5447.js"><link rel="prefetch" href="/notes-of-tan/assets/js/32.c3b24f07.js"><link rel="prefetch" href="/notes-of-tan/assets/js/33.5ac8d9ac.js"><link rel="prefetch" href="/notes-of-tan/assets/js/34.1a9ee54b.js"><link rel="prefetch" href="/notes-of-tan/assets/js/35.ffb66b35.js"><link rel="prefetch" href="/notes-of-tan/assets/js/36.5b4a09a3.js"><link rel="prefetch" href="/notes-of-tan/assets/js/37.4e57a711.js"><link rel="prefetch" href="/notes-of-tan/assets/js/4.50b4a68e.js"><link rel="prefetch" href="/notes-of-tan/assets/js/5.acd9cc34.js"><link rel="prefetch" href="/notes-of-tan/assets/js/6.98a1c6f4.js"><link rel="prefetch" href="/notes-of-tan/assets/js/7.1140570f.js"><link rel="prefetch" href="/notes-of-tan/assets/js/8.bd5a1ed5.js"><link rel="prefetch" href="/notes-of-tan/assets/js/9.98e24ffb.js">
    <link rel="stylesheet" href="/notes-of-tan/assets/css/0.styles.9802d8bc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/notes-of-tan/" class="home-link router-link-active"><!----> <span class="site-name">Notes of Tan</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/java/javaBasics.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Java Basics
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/java/javaUtils.html" class="nav-link">
  Java Utilities
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/java/javaConcurrency.html" class="nav-link">
  Java Concurrency
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/java/javaIO.html" class="nav-link">
  IO
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/java/javaMisc.html" class="nav-link">
  Java Miscellanea
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/java/JVM.html" class="nav-link">
  Java Virtual Machine
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Backend" class="dropdown-title"><span class="title">Backend</span> <span class="arrow down"></span></button> <button type="button" aria-label="Backend" class="mobile-dropdown-title"><span class="title">Backend</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/SpringNotes.html" class="nav-link">
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/OS-notes.html" class="nav-link">
  OS
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/database.html" class="nav-link">
  Database
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/SQL_notes.html" class="nav-link">
  SQL
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/distributed.html" class="nav-link">
  Distributed System
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/redis-notes.html" class="nav-link">
  Redis
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Frontend" class="dropdown-title"><span class="title">Frontend</span> <span class="arrow down"></span></button> <button type="button" aria-label="Frontend" class="mobile-dropdown-title"><span class="title">Frontend</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes-of-tan/CSS-notes.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/html-notes.html" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/todo/jsNotes.html" class="nav-link">
  JS, TS
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/BOM_DOM_notes.html" class="nav-link">
  BOM, DOM, Web API
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/todo/react_notes.html" class="nav-link">
  React
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Other" class="dropdown-title"><span class="title">Other</span> <span class="arrow down"></span></button> <button type="button" aria-label="Other" class="mobile-dropdown-title"><span class="title">Other</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes-of-tan/algo_notes.html" class="nav-link">
  Algorithm
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/git_notes.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/DesignPatternNotes.html" class="nav-link">
  Design Pattern
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/HTTP.html" class="nav-link">
  HTTP
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/mac-notes.html" class="nav-link">
  MacOS
</a></li></ul></div></div> <a href="https://github.com/tangentyh/notes-of-tan" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/java/javaBasics.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Java Basics
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/java/javaUtils.html" class="nav-link">
  Java Utilities
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/java/javaConcurrency.html" class="nav-link">
  Java Concurrency
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/java/javaIO.html" class="nav-link">
  IO
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/java/javaMisc.html" class="nav-link">
  Java Miscellanea
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/java/JVM.html" class="nav-link">
  Java Virtual Machine
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Backend" class="dropdown-title"><span class="title">Backend</span> <span class="arrow down"></span></button> <button type="button" aria-label="Backend" class="mobile-dropdown-title"><span class="title">Backend</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/SpringNotes.html" class="nav-link">
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/OS-notes.html" class="nav-link">
  OS
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/database.html" class="nav-link">
  Database
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/SQL_notes.html" class="nav-link">
  SQL
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/distributed.html" class="nav-link">
  Distributed System
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/backend/redis-notes.html" class="nav-link">
  Redis
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Frontend" class="dropdown-title"><span class="title">Frontend</span> <span class="arrow down"></span></button> <button type="button" aria-label="Frontend" class="mobile-dropdown-title"><span class="title">Frontend</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes-of-tan/CSS-notes.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/html-notes.html" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/todo/jsNotes.html" class="nav-link">
  JS, TS
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/BOM_DOM_notes.html" class="nav-link">
  BOM, DOM, Web API
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/todo/react_notes.html" class="nav-link">
  React
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Other" class="dropdown-title"><span class="title">Other</span> <span class="arrow down"></span></button> <button type="button" aria-label="Other" class="mobile-dropdown-title"><span class="title">Other</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes-of-tan/algo_notes.html" class="nav-link">
  Algorithm
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/git_notes.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/DesignPatternNotes.html" class="nav-link">
  Design Pattern
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/HTTP.html" class="nav-link">
  HTTP
</a></li><li class="dropdown-item"><!----> <a href="/notes-of-tan/mac-notes.html" class="nav-link">
  MacOS
</a></li></ul></div></div> <a href="https://github.com/tangentyh/notes-of-tan" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Java</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes-of-tan/backend/java/javaBasics.html" aria-current="page" class="active sidebar-link">Java Basics</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Docs" class="sidebar-link">Docs</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#CLI" class="sidebar-link">CLI</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#JAR" class="sidebar-link">JAR</a></li></ul></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Philosophy" class="sidebar-link">Philosophy</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Control-Flow" class="sidebar-link">Control Flow</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Package" class="sidebar-link">Package</a></li></ul></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Fundamentals" class="sidebar-link">Fundamentals</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Data-Types" class="sidebar-link">Data Types</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#primitive-types" class="sidebar-link" style="padding-left:3rem;">primitive types</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#primitive-type-conversion" class="sidebar-link" style="padding-left:4rem;">primitive type conversion</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#other-types" class="sidebar-link" style="padding-left:3rem;">other types</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Classes-and-Modifiers" class="sidebar-link">Classes and Modifiers</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Math" class="sidebar-link">Math</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Built-In-Classes" class="sidebar-link">Built-In Classes</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#System" class="sidebar-link" style="padding-left:3rem;">System</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#String" class="sidebar-link" style="padding-left:3rem;">String</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Object-Wrappers" class="sidebar-link" style="padding-left:3rem;">Object Wrappers</a></li></ul></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Inheritance" class="sidebar-link">Inheritance</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Interfaces-Lambdas-and-Inner-Classes" class="sidebar-link">Interfaces, Lambdas and Inner Classes</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Interfaces" class="sidebar-link">Interfaces</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Common-Interfaces" class="sidebar-link" style="padding-left:3rem;">Common Interfaces</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Lambdas" class="sidebar-link">Lambdas</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Common-Functional-Interfaces" class="sidebar-link" style="padding-left:3rem;">Common Functional Interfaces</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Inner-Class" class="sidebar-link">Inner Class</a></li></ul></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Reflection" class="sidebar-link">Reflection</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Proxy" class="sidebar-link">Proxy</a></li></ul></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Error-Handling" class="sidebar-link">Error Handling</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Debugging" class="sidebar-link">Debugging</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Exceptions" class="sidebar-link">Exceptions</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Exception-Handling" class="sidebar-link">Exception Handling</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Assertion" class="sidebar-link">Assertion</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Logging" class="sidebar-link">Logging</a></li></ul></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Generics" class="sidebar-link">Generics</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Annotations" class="sidebar-link">Annotations</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Standard-Annotations" class="sidebar-link">Standard Annotations</a></li><li class="sidebar-sub-header"><a href="/notes-of-tan/backend/java/javaBasics.html#Source-Level-Annotation-Processing" class="sidebar-link">Source-Level Annotation Processing</a></li></ul></li></ul></li><li><a href="/notes-of-tan/backend/java/javaUtils.html" class="sidebar-link">Java Utils</a></li><li><a href="/notes-of-tan/backend/java/javaConcurrency.html" class="sidebar-link">Java Concurrency</a></li><li><a href="/notes-of-tan/backend/java/javaIO.html" class="sidebar-link">IO</a></li><li><a href="/notes-of-tan/backend/java/javaMisc.html" class="sidebar-link">Java Miscellanea</a></li><li><a href="/notes-of-tan/backend/java/JVM.html" class="sidebar-link">JVM</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="Java-Basics"><a href="#Java-Basics" class="header-anchor">#</a> Java Basics</h1> <h2 id="Docs"><a href="#Docs" class="header-anchor">#</a> Docs</h2> <ol><li><p>docs</p> <ul><li><a href="https://docs.oracle.com/javase/8/docs/api/index.html" target="_blank" rel="noopener noreferrer">oracle JDK 1.8<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.oracle.com/javase/9/jshell/toc.htm" target="_blank" rel="noopener noreferrer">jshell<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.oracle.com/javase/8/docs/technotes/tools/unix/toc.html" target="_blank" rel="noopener noreferrer">Java Platform, Standard Edition Tools Reference for Oracle JDK on Solaris, Linux, and OS X, Release 8<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://download.oracle.com/otndocs/jcp/jdbc-4_3-mrel3-spec/index.html" target="_blank" rel="noopener noreferrer">JSR-000221 JDBC API 4.3 Maintenance Release 3<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://stackoverflow.com/questions/6986993/how-to-download-javadoc-to-read-offline/36497090" target="_blank" rel="noopener noreferrer">download<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li><a href="https://www.oracle.com/technetwork/java/javase/documentation/jdk8-doc-downloads-2133158.html" target="_blank" rel="noopener noreferrer">Java Development Kit 8 Documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></li> <li><p><a href="http://docs.oracle.com/javase/specs" target="_blank" rel="noopener noreferrer">specification<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li><a href="https://docs.oracle.com/javase/specs/jvms/se8/html/" target="_blank" rel="noopener noreferrer">The Java® Virtual Machine Specification<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ol> <h2 id="CLI"><a href="#CLI" class="header-anchor">#</a> CLI</h2> <ol><li><p><code>javac</code> — compile</p> <ul><li>timestamps aware — auto compile dependencies and recompile when source file updated according to timestamps</li> <li>extra options — <code>--help-extra</code>, <code>-X</code></li> <li><code>-Xlint:&lt;key&gt;(,&lt;key&gt;)*</code> — enable warnings
<ul><li><code>-Xlint</code> or <code>-Xlint:all</code> — all checks</li> <li><code>-Xlint:deprecation</code> — Same as <code>-deprecation</code>, checks for deprecated methods</li> <li><code>-Xlint:fallthrough</code> — Checks for missing <code>break</code> statements in <code>switch</code> statements</li> <li><code>-Xlint:finally</code> — Warns about finally clauses that cannot complete normally</li> <li><code>-Xlint:none</code> — Carries out none of the checks</li> <li><code>-Xlint:path</code> — Checks that all directories on the class path and source path exist</li> <li><code>-Xlint:serial</code> — Warns about serializable classes without <code>serialVersionUID</code></li> <li><code>-Xlint:unchecked</code> — Warns of unsafe conversions between generic and raw types</li></ul></li></ul></li> <li><p><code>java</code> — execute</p> <ul><li>synopsis<div class="language- extra-class"><pre class="language-text"><code>java [options] &lt;mainclass&gt; [args...]
    (to execute a class)
java [options] -m &lt;module&gt;[/&lt;mainclass&gt;] [args...]
java [options] --module &lt;module&gt;[/&lt;mainclass&gt;] [args...]
    (to execute the main class in a module)
</code></pre></div><ul><li>args in <code>public static void main(String[] args)</code> — class name is not included<div class="language-shell extra-class"><pre class="language-shell"><code>java Message -g cruel world
<span class="token comment"># args: [&quot;-g&quot;, &quot;cruel&quot;, &quot;world&quot;]</span>
</code></pre></div></li> <li>jar — <code>java -jar MyProgram.jar</code>, see <a href="#JAR">Jar</a><div class="language- extra-class"><pre class="language-text"><code>java [options] -jar &lt;jarfile&gt; [args...]
</code></pre></div></li> <li>single source file program — compile and run, no <code>.class</code> file generated<div class="language- extra-class"><pre class="language-text"><code>java [options] &lt;sourcefile&gt; [args]
</code></pre></div><div class="language-shell extra-class"><pre class="language-shell"><code>java ClassName.java
</code></pre></div></li></ul></li> <li><code>-cp</code> or <code>-classpath</code> — specify the class path<div class="language-shell extra-class"><pre class="language-shell"><code>java -classpath /home/user/classdir:.:/home/user/archives/archive.jar MyProg
</code></pre></div></li> <li><code>-verbose</code> — watch class loading</li> <li><code>java -X</code> — a listing of all nonstandard options
<ul><li><code>-Xprof</code> — profiling, support was removed in JDK 10</li> <li><code>-XshowSettings:properties</code>, <code>-XshowSettings:locale</code></li> <li><code>-Xverify:none</code>, or <code>-noverify</code> — turn off verification when loading classes</li> <li>memory related — see <a href="/notes-of-tan/backend/java/JVM.html#Memory">JVM</a></li></ul></li> <li>enable and disable assertion — see <a href="#Assertion">Assertion</a></li> <li>system properties — <code>-D</code>, <code>System::getProperty</code>, <code>System::getProperties</code> <ul><li>log related — see <a href="#Logging">Logging</a> <ul><li>log configuration file location — <code>-Djava.util.logging.config.file=configFile</code></li></ul></li> <li>see <a href="/notes-of-tan/backend/java/javaUtils.html#Legacy-Collections"><code>Properties</code></a> for list of system properties</li></ul></li> <li>remote debug<div class="language-shell extra-class"><pre class="language-shell"><code>java -Xdebug -Xrunjdwp:server<span class="token operator">=</span>y,transport<span class="token operator">=</span>dt_socket,address<span class="token operator">=</span><span class="token number">8000</span>,suspend<span class="token operator">=</span>n <span class="token punctuation">\</span>
  -jar target/myapplication-0.0.1-SNAPSHOT.jar <span class="token comment"># remote debug</span>
</code></pre></div></li></ul></li> <li><p><code>javaw</code> — <code>java</code> without a shell window</p></li> <li><p><code>javadoc</code> — generates HTML documentation from your source files</p> <ul><li>information source
<ul><li>Packages</li> <li>Public classes and interfaces</li> <li>Public and protected fields</li> <li>Public and protected constructors and methods</li></ul></li> <li>assets directory — <code>/doc-files</code> directory for assets</li> <li>syntax
<ul><li><code>/** ... */</code></li> <li>tags <code>@</code> <ul><li><code>@param variable description</code></li> <li><code>@return description</code></li> <li><code>@throws class description</code></li> <li>more</li></ul></li> <li>HTML tags
<ul><li>use <code>{@code ... }</code> instead of <code>&lt;code&gt;...&lt;/code&gt;</code> to cope with escaping of <code>^</code></li></ul></li></ul></li> <li>example<div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * Raises the salary of an employee.
 * @param byPercent the percentage by which to raise the salary (e.g. 10 means 10%)
 * @return the amount of the raise
 */</span>
<span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">raiseSalary</span><span class="token punctuation">(</span><span class="token keyword">double</span> byPercent<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div></li> <li>more</li></ul></li> <li><p><code>javap</code> — print java class information</p> <ul><li><code>-v</code> — verbose</li> <li><code>-c</code> — Disassemble the code
<ul><li>can be used to inspect if atomic</li></ul></li></ul></li> <li><p><code>jshell</code> — REPL from Java 9</p></li> <li><p><code>jconsole</code> — Java Monitoring and Management Console</p></li> <li><p><code>jmap</code> and <code>jhat</code> (deprecated) for heap dump and examining dump — see <a href="#Debugging">Debugging</a></p></li> <li><p><code>serialver</code> — get serial version ID</p></li> <li><p>sign</p> <ul><li><code>keytool</code> — signatures, certificates
<ul><li>password for cacerts — <code>changeit</code></li></ul></li> <li><code>jarsigner</code> — add a signature to a (jar) file</li></ul></li> <li><p><code>javah</code> — produces a C header file from class files for <code>native</code> methods</p></li></ol> <h3 id="JAR"><a href="#JAR" class="header-anchor">#</a> JAR</h3> <ol><li><p><code>jar</code> — creates an archive for classes and resources, and can manipulate or restore individual classes or resources from an archive</p> <div class="language-shell extra-class"><pre class="language-shell"><code>jar <span class="token punctuation">[</span>OPTION<span class="token punctuation">..</span>.<span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token punctuation">[</span>--release VERSION<span class="token punctuation">]</span> <span class="token punctuation">[</span>-C dir<span class="token punctuation">]</span> files<span class="token punctuation">]</span> <span class="token punctuation">..</span>.
</code></pre></div><ul><li><a href="https://docs.oracle.com/javase/8/docs/technotes/guides/jar/" target="_blank" rel="noopener noreferrer">docs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>compression — ZIP</li> <li>similar to <code>tar</code><div class="language-shell extra-class"><pre class="language-shell"><code>jar cvf JARFileName File1 File2 <span class="token punctuation">..</span>.
</code></pre></div></li> <li><code>.exe</code> wrapper — Launch4J, IzPack, etc.</li> <li>resources
<ul><li>resources finding — delegates to class loader, which remembers how to locate the class, so it can then search for the associated resource in the same location</li> <li><code>URL Class::getResource(String name)</code>, <code>InputStream Class::getResourceAsStream(String name)</code></li> <li>resource name
<ul><li>absolute — starts with <code>/</code></li> <li>relative — <code>data/text/about.txt</code></li></ul></li></ul></li></ul></li> <li><p>manifest</p> <div class="language-manifest extra-class"><pre class="language-text"><code>Manifest-Version: 1.0
lines describing this archive

Name: Woozle.class
lines describing this file
Name: com/mycompany/mypkg/
lines describing this package
</code></pre></div><ul><li>each jar file contains a <code>META-INF/MANIFEST.MF</code> manifest file</li> <li>syntax — key-value entries
<ul><li>main section — starts with <code>Manifest-Version</code>, applies to the whole JAR file</li> <li>subsequent entries — starts with <code>Name</code>, can specify properties of named entities such as individual files, packages, or URLs</li> <li>section delimiter — blank lines</li> <li>file end — the file must end with a newline</li></ul></li> <li>edit manifest<div class="language-shell extra-class"><pre class="language-shell"><code>jar cfm JARFileName ManifestFileName <span class="token punctuation">..</span>. <span class="token comment"># create</span>
jar ufm MyArchive.jar manifest-additions.mf <span class="token comment"># update</span>
</code></pre></div></li> <li>specify entry point for execution
<ul><li><code>jar -e</code> option</li> <li><code>Main-Class</code> in manifest</li> <li>execution — <code>java -jar MyProgram.jar</code></li></ul></li> <li>sealing — a package can have no more classes, <code>Sealed: boolean</code>, <code>false</code> by default<div class="language-manifest extra-class"><pre class="language-text"><code>Name: com/mycompany/util/
Sealed: true
</code></pre></div><ul><li>global default defined in main section</li></ul></li></ul></li></ol> <h2 id="Philosophy"><a href="#Philosophy" class="header-anchor">#</a> Philosophy</h2> <ol><li><p>class based</p> <ul><li>everything inside class</li></ul></li> <li><p>camelCase naming</p> <ul><li><code>Character.isJavaIdentifierStart()</code> and <code>Character.isJavaIdentifierPart()</code></li> <li><code>$</code> is intended for names that are generated by the Java compiler and other tools</li></ul></li> <li><p>curly braces and semicolons</p></li> <li><p>initialize local variables before read otherwise compilation error</p></li> <li><p>does not have operator overloading</p></li></ol> <h3 id="Control-Flow"><a href="#Control-Flow" class="header-anchor">#</a> Control Flow</h3> <ol><li><p>no block variable shadowing — may not declare identically named variables in two nested blocks</p> <ul><li>in JS and C++ inner one shadows outer one</li></ul></li> <li><p><code>switch</code></p> <ul><li>A case label can be
<ul><li>primitive type expressions — a constant expression of type <code>char</code> , <code>byte</code> , <code>short</code> , or <code>int</code></li> <li><code>Enum</code> — like <code>with</code> in JS<div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Size</span> sz <span class="token operator">=</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">;</span>
<span class="token keyword">switch</span> <span class="token punctuation">(</span>sz<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">case</span> SMALL<span class="token operator">:</span> <span class="token comment">// no need to use Size.SMALL</span>
        <span class="token comment">// . . .</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token comment">// . . .</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li>strings — Starting with Java SE 7, a string literal, uses <code>hashCode()</code> behind scenes</li></ul></li></ul></li> <li><p>labeled <code>break</code> and <code>continue</code> — for labeled blocks, can only jump out of a block, never into a block</p></li> <li><p>iterator — <code>for (variable : collection) statement</code></p> <ul><li><code>collection</code> — an array or an object of a class that implements the <code>Iterable</code> interface</li> <li>see <a href="/notes-of-tan/backend/java/javaUtils.html#Collections">Collections</a></li></ul></li> <li><p>vararg parameter — <code>...</code></p> <ul><li>if only an array passed, then that array is used, without nesting</li></ul></li></ol> <h3 id="Package"><a href="#Package" class="header-anchor">#</a> Package</h3> <ol><li><p>package</p> <ul><li>package name — reversely ordered domain</li> <li>package availability — A class can use all classes from its own package and all public classes from other packages.</li> <li>package at runtime
<ul><li>locating classes is done by compiler — the only benefit of the <code>import</code> statement is convenience</li> <li>canonical name after compilation — the byte codes in class files always canonical names to refer to other classes</li></ul></li></ul></li> <li><p>class importation</p> <ul><li>built-in — <code>java.lang</code></li> <li>without <code>import</code> — use canonical name</li> <li><code>import</code> statement<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">LocalDate</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>import a class — canonical name</li> <li>import a package — <code>*</code></li> <li>import a inner class — <code>java.util.AbstractMap.SimpleEntry</code></li> <li>solve name conflict — import the specific class, or use canonical name<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token comment">// compile-time error when use `Date` class</span>
</code></pre></div></li></ul></li> <li>static imports — the importing of static methods and fields<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span><span class="token class-name">System</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li><p>add to package — put the name of the package at the top of a source file</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>directory — match the canonical name<div class="language-shell extra-class"><pre class="language-shell"><code>javac com/mycompany/PayrollApp.java
java com.mycompany.PayrollApp
</code></pre></div></li> <li>default package — classes belong to the default package if no <code>package</code> statement</li> <li>no custom <code>java.</code> prefixed packages — disallow loading of user-defined classes whose package name starts with &quot;<code>java.</code>&quot;</li></ul></li> <li><p>class path</p> <div class="language- extra-class"><pre class="language-text"><code>/home/user/classdir:.:/home/user/archives/archive.jar
c:\classdir;.;c:\archives\archive.jar
</code></pre></div><ul><li>system property — <code>java.class.path</code></li> <li>possible components<div class="language-shell extra-class"><pre class="language-shell"><code>/home/user/classdir:.:/home/user/archives/<span class="token string">'*'</span>
<span class="token comment"># - In UNIX, the `*` must be escaped to prevent shell expansion.</span>
<span class="token comment"># c:\classdir;.;c:\archives\*</span>
</code></pre></div><ul><li>base directory for the package tree</li> <li>jar files</li> <li>jar file directory</li> <li>do not add runtime libary files — <code>rt.jar</code> and the other JAR files in the <code>jre/lib</code> and <code>jre/lib/ext</code> directories are always searched for classes (modules from JDK 9, and no more <code>ext</code>)</li></ul></li> <li>used by <code>java</code> but not <code>javac</code> <ul><li>the <code>javac</code> compiler — always looks for files in the current directory</li> <li>the <code>java</code> virtual machine — launcher only looks into the class path, default class path is <code>.</code></li></ul></li> <li>class search order
<ul><li>for <code>javac</code> — from <code>java.lang</code> to imports to current package</li> <li>for <code>java</code> — from runtime libary to the class path</li></ul></li> <li>set class path
<ul><li><code>-cp</code> or <code>-classpath</code> option<div class="language-shell extra-class"><pre class="language-shell"><code>java -classpath /home/user/classdir:.:/home/user/archives/archive.jar MyProg
<span class="token comment"># java -classpath c:\classdir;.;c:\archives\archive.jar MyProg</span>
</code></pre></div></li> <li>the <code>CLASSPATH</code> environment variable</li></ul></li></ul></li></ol> <h2 id="Fundamentals"><a href="#Fundamentals" class="header-anchor">#</a> Fundamentals</h2> <h3 id="Data-Types"><a href="#Data-Types" class="header-anchor">#</a> Data Types</h3> <h4 id="primitive-types"><a href="#primitive-types" class="header-anchor">#</a> primitive types</h4> <ol><li><p>integer types</p> <ul><li>types
<ul><li><code>byte</code></li> <li><code>short</code> — 2 bytes</li> <li><code>int</code></li> <li><code>long</code></li></ul></li> <li>number literals
<ul><li><code>long</code> — <code>l</code> or <code>L</code> suffix for <code>long</code> type</li> <li>hexadecimal, octal and binary — <code>0x</code>, <code>0</code>, <code>0b</code> or <code>0B</code></li> <li>friendly underscores — <code>1_000_000</code>, <code>0b1111_0100_0010_0100_0000</code></li></ul></li> <li>no <code>unsigned</code></li> <li>shift overflow bits — mod<div class="language-java extra-class"><pre class="language-java"><code><span class="token number">1l</span> <span class="token operator">&lt;&lt;</span> <span class="token number">65</span> <span class="token comment">// 1l &lt;&lt; (65 % 64)</span>
</code></pre></div></li></ul></li> <li><p>float point types</p> <ul><li>types
<ul><li><code>float</code> — 4 bytes</li> <li><code>double</code></li></ul></li> <li>number literals
<ul><li><code>float</code> — <code>f</code> or <code>F</code> suffix</li> <li><code>double</code> — <code>d</code>, <code>D</code> suffix or no suffix</li> <li>exponent — <code>e</code></li> <li>binary exponent — <code>p</code>, e.g. <code>0x1.0p-3</code> (2^-3)</li></ul></li> <li>overflows and errors
<ul><li><code>Double.POSITIVE_INFINITY</code>, <code>Double.NEGATIVE_INFINITY</code>, and <code>Double.NaN</code>, also in <code>Float</code></li> <li><code>Double::isNaN</code>, also in <code>Float</code></li></ul></li></ul></li> <li><p><code>char</code> — describes a code unit in the UTF-16 BE encoding</p> <ul><li>syntax — single quote</li> <li>Unicode escaping, e.g. <code>\u0fff</code> — inside and outside quotes<div class="language-Java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span>\u005B\u005D args<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token string">&quot;\u0022+\u0022&quot;</span> <span class="token comment">// yielding &quot;&quot;+&quot;&quot;</span>
<span class="token comment">// \u000A is a newline // syntax error</span>
<span class="token comment">// since \u000A is replaced with a newline when the program is read</span>
<span class="token comment">// Look inside c:\users // syntax error</span>
</code></pre></div><ul><li>processing — Unicode escape sequences are processed before the code is parsed</li> <li>other escapes — <code>\b</code>, <code>\t</code>, <code>\n</code>, <code>\r</code></li> <li><code>native2ascii</code> — CLI for converting the native character encoding to plain ASCII, removed in JDK 9 due to the ability to support UTF-8 based properties resource bundles</li></ul></li> <li>code unit — a 16-bit value
<ul><li>supplementary characters — whose code points are greater than <code>U+FFFF</code>, encoded as consecutive pairs of code units, a range of 2048 unused values of the basic multilingual plane</li> <li>surrogates area — high-surrogates range <code>U+D800</code> to <code>U+DBFF</code> for the first code unit, low-surrogates range <code>U+DC00</code> to <code>U+DFFF</code> for the second code unit</li></ul></li></ul></li> <li><p><code>boolean</code></p> <ul><li>cannot convert between integers and boolean values</li> <li><code>if (x = 0)</code> does not compile</li> <li>stored as <code>int</code></li></ul></li></ol> <h5 id="primitive-type-conversion"><a href="#primitive-type-conversion" class="header-anchor">#</a> primitive type conversion</h5> <ol><li><p>conversion</p> <ul><li>legal conversion — types with less information to types with more information, but not vice versa</li> <li>type priority — <code>double</code> &gt; <code>float</code> &gt; <code>long</code> &gt; <code>int</code> &gt; <code>char</code></li> <li>implicit conversion using operators — converted to a common type before the operation is carried out
<ul><li>example — for <code>int x</code>, <code>x += 3.5</code> is <code>x = (int)(x + 3.5)</code></li></ul></li></ul></li> <li><p>casts</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token number">9.997</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> nx <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> x<span class="token punctuation">;</span>
<span class="token keyword">int</span> nx2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Math.round() return long for double, int for float</span>
</code></pre></div><ul><li>truncate when out of range — <code>(byte) 300</code> is 44</li> <li>not between <code>boolean</code> and number — cannot cast between <code>boolean</code> values and any numeric type</li></ul></li></ol> <h4 id="other-types"><a href="#other-types" class="header-anchor">#</a> other types</h4> <ol><li><p><code>enum</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">enum</span> <span class="token class-name">Size</span> <span class="token punctuation">{</span> SMALL<span class="token punctuation">,</span> MEDIUM<span class="token punctuation">,</span> LARGE<span class="token punctuation">,</span> EXTRA_LARGE <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">Size</span> s <span class="token operator">=</span> <span class="token class-name">Size</span><span class="token punctuation">.</span>MEDIUM<span class="token punctuation">;</span> <span class="token comment">// s can be null</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Size</span> <span class="token punctuation">{</span>
    <span class="token function">SMALL</span><span class="token punctuation">(</span><span class="token string">&quot;S&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">MEDIUM</span><span class="token punctuation">(</span><span class="token string">&quot;M&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">LARGE</span><span class="token punctuation">(</span><span class="token string">&quot;L&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">EXTRA_LARGE</span><span class="token punctuation">(</span><span class="token string">&quot;XL&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> abbreviation<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Size</span><span class="token punctuation">(</span><span class="token class-name">String</span> abbreviation<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>abbreviation <span class="token operator">=</span> abbreviation<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAbbreviation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> abbreviation<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>enum</code> extends <code>Enum</code> — <code>Size</code> is actually a subclass of <code>Enum</code>, having exactly four instances (static field)
<ul><li>singleton — not possible to construct new objects, <code>==</code> can be used</li></ul></li> <li>implicitly defined methods (i.e. added by the compiler)
<ul><li><code>static E[] values()</code></li> <li><code>static E valueOf(String name)</code></li></ul></li></ul></li> <li><p><code>Enum</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Enum</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span> <span class="token keyword">extends</span> <span class="token class-name">Enum</span><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">extends</span> <span class="token class-name">Object</span>
<span class="token keyword">implements</span> <span class="token class-name">Comparable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token class-name">Serializable</span>
</code></pre></div><ul><li><code>String toString()</code></li> <li><code>static &lt;T extends Enum&lt;T&gt;&gt; T valueOf(Class&lt;T&gt; enumType, String name)</code></li> <li><code>int ordinal()</code></li> <li><code>int compareTo(E other)</code> — by ordinal number</li></ul></li> <li><p>arrays</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> smallPrimes <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> smallPrimes2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">37</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">37</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// anonymous array</span>
</code></pre></div><ul><li>arrays are objects — extends <code>Object</code> and implements <code>Cloneable</code>, <code>Serializable</code> <ul><li><code>final int length</code></li> <li><code>T[] clone()</code></li> <li><code>Object</code> methods</li></ul></li> <li>initialization — zero, <code>false</code>, or <code>null</code></li> <li>two dimensional<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> balances<span class="token punctuation">;</span>
balances <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">double</span><span class="token punctuation">[</span>NYEARS<span class="token punctuation">]</span><span class="token punctuation">[</span>NRATES<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> magicSquare <span class="token operator">=</span>
    <span class="token punctuation">{</span>
        <span class="token punctuation">{</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li> <li>ragged<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> odds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>NMAX <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> n <span class="token operator">&lt;=</span> NMAX<span class="token punctuation">;</span> n<span class="token operator">++</span><span class="token punctuation">)</span>
    odds<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li></ol> <h3 id="Classes-and-Modifiers"><a href="#Classes-and-Modifiers" class="header-anchor">#</a> Classes and Modifiers</h3> <ol><li><p><code>public class</code></p> <ul><li>filename and class name — the name of the file must match the name of the <code>public</code> class</li> <li>unique in a file — can only have one <code>public</code> class in a source file</li> <li>when run <code>java ClassName</code> in CLI, the <code>main</code> method in <code>ClassName</code> is run</li></ul></li> <li><p><code>class</code></p> <ul><li><code>this</code> <ul><li>field variable shadowing — <code>this.</code> is optional, local variables can shadow instance fields</li> <li>implicit parameter — implicit parameter <code>this</code> does not appear in the method declaration
<ul><li>can be explicitly declared as the first parameter, usually for annotations</li></ul></li> <li>as constructor — constructor call in the form <code>this(...)</code> must be the first statement in a constructor</li></ul></li> <li>initialization
<ul><li>implicit field initialization — fields automatically set to a default zero</li> <li>explicit field initialization — initialize with constant value or an expression</li> <li>initialization block
<ul><li>can be <code>static</code> — static initialization block, executed when loading the class</li> <li>can set fields but cannot read later fields — legal to set fields defined later in the class. However, to avoid circular definitions, not legal to read from fields initialized later</li></ul></li> <li>execution order — runs after <code>super()</code> call or other constructor call, but before the rest of the constructor, see below</li></ul></li> <li>constructors
<ul><li>method name — same as the class</li> <li><code>new</code> — must be called with <code>new</code></li> <li>default no-arg constructor — when no constructor present, a no-argument constructor is provided</li> <li>call another constructor — see <code>this</code> above</li></ul></li> <li>execution order when a constructor is called
<ol><li>other constructor call — if the first line of the constructor calls a second constructor, then the second constructor runs before the body of this constructor.</li> <li>implicit field initialization — all data fields are initialized to their default values (0 , <code>false</code> , or <code>null</code>)</li> <li>explicit field initialization and initialization blocks — all field initializers and initialization blocks are executed, in the order they appear in the class declaration</li> <li>the rest — The body of the constructor is executed.</li></ol></li> <li>encapsulation
<ul><li>getter, setter — <code>private</code> data field with <code>public</code> accessor and mutator</li> <li>return clone for mutable objects — If you need to return a reference to a mutable object, return a clone</li></ul></li> <li>destructor
<ul><li>garbage collection — Java does automatic garbage collection, does not support destructors</li> <li><code>Object::finalize</code> deprecated since JDK 9 and <code>java.lang.ref.PhantomReference</code> — see <a href="/notes-of-tan/backend/java/JVM.html#Reference">JVM</a>, and javadoc of <code>Object::finalize</code> tbd</li> <li><code>Runtime::addShutdownHook</code> — when JVM shutdown</li></ul></li></ul></li> <li><p>access modifiers</p> <ul><li><code>public</code> — no access limit</li> <li><code>private</code> — accessible only when the class is the same</li> <li><code>protected</code> — can be accessed by subclasses and within the same package
<ul><li>limitation to subclasses — when not within the same package, <code>SuperType.protectedField</code> are not accessible to subclass</li></ul></li> <li>default package access — when no access modifiers specified, can be accessed within the same package</li> <li>access privileges when overriding — no more restrictive access privileges when overriding</li></ul></li> <li><p>other modifiers</p> <ul><li><code>final</code> <ul><li><code>final</code> fields — must be initialized when the object is constructed (can be initialized in constructor) and cannot be modified</li> <li><code>final</code> methods — cannot be overloaded</li> <li><code>final class</code> — cannot be inherited, and methods are automatically <code>final</code></li> <li><code>final</code> parameters — cannot be modified</li></ul></li> <li><code>static</code> <ul><li>call by instance — static methods can be invoked by object call, but not recommended</li> <li>execution order — static initialization occurs when the class is first loaded</li> <li>get class from static method (<code>this.getClass()</code> will not work in static methods) besides <code>.class</code> property<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEnclosingClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li><code>strictfp</code> — methods tagged with the <code>strictfp</code> keyword must use strict rules for floating-point computations that yield reproducible results</li></ul></li></ol> <h3 id="Math"><a href="#Math" class="header-anchor">#</a> Math</h3> <ol><li><p><code>Math</code> — elementary exponential, logarithm, square root, and trigonometric functions</p> <ul><li><code>Math.E</code>, <code>Math.PI</code></li> <li><code>static double random()</code> — uses <code>java.util.Random</code> behind scenes</li> <li><code>min</code>, <code>max</code></li> <li>double
<ul><li><code>public static double ulp(double d)</code> — an ulp, unit in the last place, of a double value is the positive distance between this floating-point value and the double value next larger in magnitude</li></ul></li> <li>rounding
<ul><li><code>static double ceil(double a)</code></li> <li><code>static long round(double a)</code><br> <code>static int round(float a)</code></li> <li><code>static double floor(double a)</code></li> <li><code>Math.floorDiv()</code></li> <li><code>Math.floorMod(x, y)</code> — <code>x - Math.floorDiv(x, y) * y</code> <ul><li>compared to <code>x % y</code> — <code>x - x / y * y</code></li></ul></li></ul></li> <li><code>-Exact</code> suffixed methods — <code>ArithmeticException</code> if overflow
<ul><li><code>addExact</code>, <code>subtractExact</code>, <code>multiplyExact</code>, <code>decrementExact</code>, <code>incrementExact</code>, <code>negateExact</code></li> <li><code>static int toIntExact(long value)</code></li></ul></li> <li>more</li></ul></li> <li><p><code>java.util.Random</code> — generate a stream of pseudorandom numbers, of which <code>Math.random()</code> uses an static inner class singleton instance</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Random</span> <span class="token keyword">extends</span> <span class="token class-name">Object</span>
<span class="token keyword">implements</span> <span class="token class-name">Serializable</span>
</code></pre></div><ul><li>creation
<ul><li><code>Random()</code></li> <li><code>Random(long seed)</code></li></ul></li> <li>thread-safe — use <code>ThreadLocalRandom</code> to avoid <code>AtomicLong::compareAndSet</code></li> <li>set — <code>void setSeed(long seed)</code></li> <li>next — for <code>boolean</code>, <code>byte</code>, <code>double</code>, <code>float</code>, <code>int</code>, <code>long</code> <ul><li><code>int nextInt()</code></li> <li><code>int nextInt(int bound)</code></li> <li>more</li> <li><code>double nextGaussian()</code></li></ul></li> <li>stream</li> <li><code>java.security.SecureRandom</code></li></ul></li> <li><p><code>StrictMath</code> — guaranteeing identical results on all platforms</p></li> <li><p><code>java.math.BigInteger</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BigInteger</span>
<span class="token keyword">extends</span> <span class="token class-name">Number</span>
<span class="token keyword">implements</span> <span class="token class-name">Comparable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BigInteger</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>creation
<ul><li><code>static BigInteger valueOf(long val)</code></li> <li><code>static BigInteger ONE</code></li> <li><code>static BigInteger TEN</code></li> <li><code>static BigInteger ZERO</code></li></ul></li> <li>arithmetic
<ul><li><code>BigInteger add(BigInteger other)</code></li> <li><code>BigInteger subtract(BigInteger other)</code></li> <li><code>BigInteger multiply(BigInteger other)</code></li> <li><code>BigInteger divide(BigInteger other)</code></li> <li><code>BigInteger mod(BigInteger other)</code></li> <li><code>BigInteger modInverse(BigInteger m)</code></li> <li><code>BigInteger modPow(BigInteger exponent, BigInteger m)</code></li> <li>more</li></ul></li></ul></li> <li><p><code>java.math.BigDecimal</code> — Immutable, arbitrary-precision signed decimal numbers, decimal version of <code>BigInteger</code></p></li></ol> <h3 id="Built-In-Classes"><a href="#Built-In-Classes" class="header-anchor">#</a> Built-In Classes</h3> <ol><li>inside <code>java.lang</code> package</li></ol> <h4 id="System"><a href="#System" class="header-anchor">#</a> System</h4> <ol><li><p><code>System</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">System</span> <span class="token keyword">extends</span> <span class="token class-name">Object</span>
</code></pre></div><ul><li>std
<ul><li><code>static InputStream in</code> — instance of <code>BufferedInputStream</code></li> <li><code>static PrintStream err</code></li> <li><code>static PrintStream out</code></li> <li><code>static Console console()</code></li> <li><code>static void setErr(PrintStream err)</code></li> <li><code>static void setIn(InputStream in)</code></li> <li><code>static void setOut(PrintStream out)</code></li></ul></li> <li>util
<ul><li><code>static native void arraycopy(Object src, int srcPos, Object dest, int destPos, int length)</code></li> <li><code>static long currentTimeMillis()</code></li> <li><code>static long nanoTime()</code></li> <li><code>static native int identityHashCode(Object x)</code> — <code>Object::hashCode</code> regardless of overriden or not, 0 for <code>null</code></li></ul></li> <li>system property — see <a href="/notes-of-tan/backend/java/javaUtils.html#Legacy-Collections">Legacy Collections</a> for the list of system properties
<ul><li><code>static Properties getProperties()</code></li> <li><code>static String getProperty(String key)</code><br> <code>static String getProperty(String key, String def)</code></li> <li><code>Integer::getInteger</code>, <code>Long::getLong</code></li> <li><code>static void setProperties(Properties props)</code><br> <code>static String setProperty(String key, String value)</code></li> <li><code>static String clearProperty(String key)</code></li> <li><code>static String lineSeparator()</code> — equivalent to <code>System.getProperty(&quot;line.separator&quot;)</code> <ul><li>see <a href="/notes-of-tan/backend/java/javaIO.html#File-Classes"><code>File</code></a> for other separators</li></ul></li></ul></li> <li>environment
<ul><li><code>static Map&lt;String,String&gt; getenv()</code></li> <li><code>static String getenv(String name)</code></li></ul></li> <li>JVM
<ul><li><code>static void exit(int status)</code></li> <li><code>static void gc()</code> — run garbage collector</li> <li><code>static SecurityManager getSecurityManager()</code></li> <li><code>static Channel inheritedChannel()</code> — the channel inherited from the entity that created this Java virtual machine</li> <li><code>static void load(String filename)</code></li> <li><code>static void loadLibrary(String libname)</code></li> <li><code>static String mapLibraryName(String libname)</code></li> <li><code>static void runFinalization()</code></li> <li><code>static void setSecurityManager(SecurityManager s)</code></li></ul></li></ul></li> <li><p><code>SecurityManager</code> — check permissions, like read / write on certain files</p></li></ol> <h4 id="String"><a href="#String" class="header-anchor">#</a> String</h4> <ol><li><p><code>CharSequence</code> — provides uniform, read-only access to many different kinds of char sequences</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">CharSequence</span>
</code></pre></div><ul><li><code>char charAt(int index)</code></li> <li><code>default IntStream chars()</code></li> <li><code>default IntStream codePoints()</code></li> <li><code>int length()</code></li> <li><code>CharSequence subSequence(int start, int end)</code></li> <li><code>String toString()</code></li></ul></li> <li><p><code>String</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">String</span> <span class="token keyword">extends</span> <span class="token class-name">Object</span>
<span class="token keyword">implements</span> <span class="token class-name">Serializable</span><span class="token punctuation">,</span> <span class="token class-name">Comparable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token class-name">CharSequence</span>
</code></pre></div><ul><li>length
<ul><li><code>int length()</code></li> <li><code>boolean isEmpty()</code></li> <li><code>int codePointCount(int startIndex, int endIndex)</code> — the number of code points<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span> cpCount <span class="token operator">=</span> greeting<span class="token punctuation">.</span><span class="token function">codePointCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> greeting<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li>substring or transform
<ul><li><code>char charAt(int index)</code>, <code>int codePointAt(int index)</code>, <code>codePointBefore</code></li> <li>conversion methods to and from <code>bytes[]</code>, <code>char[]</code></li> <li><code>String substring(int beginIndex)</code> <code>String substring(int beginIndex, int endIndex)</code></li> <li><code>String replace(char oldChar, char newChar)</code><br> <code>String replace(CharSequence target, CharSequence replacement)</code><br> <code>String replaceAll(String regex, String replacement)</code><br> <code>String replaceFirst(String regex, String replacement)</code></li> <li><code>String toLowerCase()</code> <code>String toUpperCase()</code></li> <li><code>String trim()</code></li> <li><code>String[] split(String regex)</code><br> <code>String[] split(String regex, int limit)</code></li></ul></li> <li>creation
<ul><li><code>static String format(String format, Object... args)</code><br> <code>static String format(Locale l, String format, Object... args)</code></li> <li><code>static String join(CharSequence delimiter, CharSequence... elements)</code><br> <code>static String join(CharSequence delimiter, Iterable&lt;? extends CharSequence&gt; elements)</code><br> <code>Collectors::joining</code><br> <code>StringJoiner</code></li> <li><code>valueOf</code> <ul><li><code>static String valueOf(type c)</code> — from various types</li> <li><code>static String copyValueOf(char[] data)</code> — <code>valueOf</code> equivalent<br> <code>static String copyValueOf(char[] data, int offset, int count)</code></li></ul></li> <li><code>String concat(String str)</code> — do nothing if empty string; in contrast, <code>+</code> will be compiled to temporary <code>StringBuilder</code></li> <li><code>String(byte[] bytes)</code><br> <code>String(byte[] bytes, Charset charset)</code><br> <code>String(byte[] bytes, int offset, int length)</code><br> <code>String(byte[] bytes, int offset, int length, Charset charset)</code></li> <li><code>String(int[] codePoints, int offset, int count)</code></li> <li><code>String(char[] value)</code><br> <code>String(char[] value, int offset, int count)</code></li> <li><code>String(String original)</code></li> <li><code>String(StringBuffer buffer)</code></li> <li><code>String(StringBuilder builder)</code></li></ul></li> <li>comparaison
<ul><li><code>int hashCode()</code><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span> hash <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    hash <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">*</span> hash <span class="token operator">+</span> <span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><code>boolean equals(Object other)</code>, <code>boolean equalsIgnoreCase(String other)</code> <ul><li>reference type — do not use the <code>==</code> operator to test whether two strings are equal</li> <li>string pool — only string literals are shared, not strings that are the result of operations like <code>+</code> or <code>substring</code></li></ul></li> <li><code>int compareToIgnoreCase(String str)</code></li> <li><code>boolean startsWith(String prefix)</code>, <code>boolean endsWith(String suffix)</code></li> <li><code>boolean contentEquals(CharSequence cs)</code>, <code>boolean contentEquals(StringBuffer sb)</code></li> <li><code>String intern()</code> — determined by <code>equals</code>, return the string from string pool, add to the pool if not contained already</li></ul></li> <li>transverse
<ul><li>with index <code>i</code><div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// incremental</span>
<span class="token keyword">int</span> cp <span class="token operator">=</span> sentence<span class="token punctuation">.</span><span class="token function">codePointAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Character</span><span class="token punctuation">.</span><span class="token function">isSupplementaryCodePoint</span><span class="token punctuation">(</span>cp<span class="token punctuation">)</span><span class="token punctuation">)</span> i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">else</span> i<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token comment">// decreasing</span>
i<span class="token operator">--</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Character</span><span class="token punctuation">.</span><span class="token function">isSurrogate</span><span class="token punctuation">(</span>sentence<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> i<span class="token operator">--</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> cp <span class="token operator">=</span> sentence<span class="token punctuation">.</span><span class="token function">codePointAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><code>int offsetByCodePoints()</code> — get at the i^th^ code point</li> <li><code>int offsetByCodePoints(int index, int codePointOffset)</code> — the resulted index by moving given number of code points from given index</li> <li><code>str.codePoints().toArray()</code></li></ul></li> <li>find
<ul><li><code>boolean contains(CharSequence s)</code></li> <li><code>boolean matches(String regex)</code></li> <li><code>boolean regionMatches(boolean ignoreCase, int toffset, String other, int ooffset, int len)</code> — Tests if two string regions are equal<br> <code>boolean regionMatches(int toffset, String other, int ooffset, int len)</code></li> <li><code>int indexOf(String str)</code><br> <code>int indexOf(String str, int fromIndex)</code><br> <code>int indexOf(int cp)</code><br> <code>int indexOf(int cp, int fromIndex)</code></li> <li><code>int lastIndexOf(String str)</code><br> <code>int lastIndexOf(String str, int fromIndex)</code><br> <code>int lastIndexOf(int cp)</code><br> <code>int lastIndexOf(int cp, int fromIndex)</code></li></ul></li></ul></li> <li><p><code>StringBuilder</code> — mutable, not synchronized <code>StringBuffer</code>, build a string from many small pieces</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">StringBuilder</span> <span class="token keyword">extends</span> <span class="token class-name">Object</span>
<span class="token keyword">implements</span> <span class="token class-name">Serializable</span><span class="token punctuation">,</span> <span class="token class-name">CharSequence</span>
</code></pre></div><ul><li>constructors
<ul><li><code>StringBuilder()</code></li> <li><code>StringBuilder(CharSequence seq)</code></li> <li><code>StringBuilder(int capacity)</code></li> <li><code>StringBuilder(String str)</code></li></ul></li> <li>modify
<ul><li><code>append</code></li> <li><code>StringBuilder appendCodePoint(int cp)</code></li> <li><code>void setCharAt(int i, char c)</code></li> <li><code>insert</code></li> <li><code>StringBuilder delete(int startIndex, int endIndex)</code></li> <li><code>StringBuilder deleteCharAt(int index)</code></li> <li>more</li></ul></li> <li>reuse
<ul><li><code>void setLength(int newLength)</code></li></ul></li> <li>output — <code>String toString()</code></li></ul></li> <li><p><code>StringBuffer</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">StringBuffer</span> <span class="token keyword">extends</span> <span class="token class-name">Object</span>
<span class="token keyword">implements</span> <span class="token class-name">Serializable</span><span class="token punctuation">,</span> <span class="token class-name">CharSequence</span>
</code></pre></div></li> <li><p><code>java.util.StringJoiner</code> — store components in <code>String[]</code> with doubling strategy when expanding capability, used by <code>Collectors::joining</code> and <code>String::join</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">StringJoiner</span> <span class="token keyword">extends</span> <span class="token class-name">Object</span>
</code></pre></div><ul><li>constructors
<ul><li><code>StringJoiner(CharSequence delimiter)</code></li> <li><code>StringJoiner(CharSequence delimiter, CharSequence prefix, CharSequence suffix)</code></li></ul></li> <li>use
<ul><li><code>StringJoiner add(CharSequence newElement)</code></li> <li><code>int length()</code></li> <li><code>StringJoiner merge(StringJoiner other)</code></li> <li><code>StringJoiner setEmptyValue(CharSequence emptyValue)</code></li> <li><code>String toString()</code></li></ul></li></ul></li></ol> <h4 id="Object-Wrappers"><a href="#Object-Wrappers" class="header-anchor">#</a> Object Wrappers</h4> <ol><li><p>wrappers</p> <ul><li><code>Integer</code> , <code>Long</code> , <code>Float</code> , <code>Double</code> , <code>Short</code> , <code>Byte</code> , <code>Character</code> , and <code>Boolean</code></li> <li>all extends <code>Number</code> except <code>Boolean</code> — no arithmetic operations and number conversions for boolean</li> <li>immutable and <code>final</code></li> <li>autowrapping (autoboxing) — done by compiler, nothing related to VM
<ul><li><code>valueOf</code> — example: <code>list.add(3);</code> is automatically translated to <code>list.add(Integer.valueOf(3));</code></li> <li><code>typeValue()</code> — example: the compiler translates <code>int n = list.get(i);</code> into <code>int n = list.get(i).intValue();</code></li> <li>arithmetic operations — example: <code>Integer n = 3; n++;</code> compiler automatically inserts instructions to unbox the object, increment the resulting value, and box it back.</li></ul></li> <li>fixed wrapping — wrapped into fixed objects
<ul><li><code>boolean , byte , char &lt;= 127</code></li> <li><code>short</code> , and <code>int</code> between -128 and 127</li></ul></li> <li>wrapper class references can be <code>null</code> — possible <code>NullPointerException</code></li> <li>conditional promotion — <code>Integer</code> to <code>Double</code><div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Integer</span> n <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token class-name">Double</span> x <span class="token operator">=</span> <span class="token number">2.0</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token boolean">true</span> <span class="token operator">?</span> n <span class="token operator">:</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Prints 1.0</span>
</code></pre></div></li></ul></li> <li><p><code>Number</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Number</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span>
</code></pre></div><ul><li><code>byte byteValue()</code></li> <li><code>abstract double doubleValue()</code></li> <li><code>abstract float floatValue()</code></li> <li><code>abstract int intValue()</code></li> <li><code>abstract long longValue()</code></li> <li><code>short shortValue()</code></li></ul></li> <li><p><code>Integer</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Integer</span>
<span class="token keyword">extends</span> <span class="token class-name">Number</span>
<span class="token keyword">implements</span> <span class="token class-name">Comparable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>fields
<ul><li><code>static int BYTES</code> — usually 4</li> <li><code>static int MAX_VALUE</code></li> <li><code>static int MIN_VALUE</code></li> <li><code>static int SIZE</code> — usually 32</li> <li><code>static Class&lt;Integer&gt; TYPE</code> — <code>int.class</code></li></ul></li> <li>creation
<ul><li><code>Integer(int value)</code> — deprecated since JDK 9</li> <li><code>Integer(String s)</code> — uses <code>parseInt</code> internally, deprecated since JDK 9</li> <li><code>static Integer decode(String nm)</code> — accepts decimal, hexadecimal (<code>0x</code>, <code>0X</code>, <code>#</code> prefixed), octal (<code>0</code> prefixed), can be negative</li> <li><code>static Integer valueOf(int i)</code><br> <code>static Integer valueOf(String s)</code> — uses <code>parseInt</code> internally<br> <code>static Integer valueOf(String s, int radix)</code></li></ul></li> <li>conversion to primitive types
<ul><li>methods in <code>Number</code> <ul><li><code>int intValue()</code></li></ul></li> <li><code>static int parseInt(String s)</code><br> <code>static int parseInt(String s, int radix)</code></li></ul></li> <li>arithmetic operations
<ul><li><code>static int signum(int i)</code></li> <li><code>static int sum(int a, int b)</code></li></ul></li> <li>unsigned
<ul><li><code>static int parseUnsignedInt(String s)</code></li> <li><code>static int parseUnsignedInt(String s, int radix)</code></li> <li><code>static int divideUnsigned(int dividend, int divisor)</code></li> <li><code>static int compareUnsigned(int x, int y)</code></li> <li><code>static int remainderUnsigned(int dividend, int divisor)</code></li> <li><code>static String toBinaryString(int i)</code> — two's complement representation</li> <li><code>static String toHexString(int i)</code></li> <li><code>static String toOctalString(int i)</code></li> <li><code>static String toUnsignedString(int i)</code></li> <li><code>static String toUnsignedString(int i, int radix)</code></li> <li><code>static long toUnsignedLong(int x)</code></li></ul></li> <li>bits in the two's complement
<ul><li><code>static int bitCount(int i)</code> — the number of one-bits</li> <li><code>static int highestOneBit(int i)</code></li> <li><code>static int lowestOneBit(int i)</code></li> <li><code>static int numberOfLeadingZeros(int i)</code></li> <li><code>static int numberOfTrailingZeros(int i)</code></li> <li><code>static int reverse(int i)</code></li> <li><code>static int reverseBytes(int i)</code></li> <li><code>static int rotateLeft(int i, int distance)</code></li> <li><code>static int rotateRight(int i, int distance)</code></li></ul></li> <li>for <code>int</code> <ul><li><code>static int compare(int x, int y)</code></li> <li><code>static int hashCode(int value)</code></li> <li><code>static String toString(int i)</code></li> <li><code>static String toString(int i, int radix)</code></li></ul></li></ul></li> <li><p><code>Double</code></p> <ul><li>counterparts of fields and methods in <code>Integer</code></li> <li>IEEE 754
<ul><li><code>static int MAX_EXPONENT</code></li> <li><code>static int MIN_EXPONENT</code></li> <li><code>static double MIN_NORMAL</code></li> <li><code>Math::ulp</code></li></ul></li> <li>infinite and not a number
<ul><li><code>static double NaN</code></li> <li><code>static double NEGATIVE_INFINITY</code></li> <li><code>static double POSITIVE_INFINITY</code></li> <li><code>static boolean isFinite(double d)</code></li> <li><code>boolean isInfinite()</code></li> <li><code>static boolean isInfinite(double v)</code></li> <li><code>boolean isNaN()</code></li> <li><code>static boolean isNaN(double v)</code></li></ul></li></ul></li> <li><p><code>Character</code> — see after</p></li> <li><p><code>Boolean</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Boolean</span> <span class="token keyword">extends</span> <span class="token class-name">Object</span>
<span class="token keyword">implements</span> <span class="token class-name">Serializable</span><span class="token punctuation">,</span> <span class="token class-name">Comparable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Boolean</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li></ol> <h2 id="Inheritance"><a href="#Inheritance" class="header-anchor">#</a> Inheritance</h2> <ol><li><p>inheritance</p> <ul><li><code>extends</code></li> <li><code>super</code></li> <li><code>super()</code> <ul><li>first statement — the call using <code>super</code> must be the first statement in the constructor for the subclass</li> <li>default no-arg constructor — if the subclass constructor does not call a superclass constructor explicitly, the no-argument <code>super()</code> is invoked</li> <li>order — invoked before initializers</li></ul></li> <li>polymorphism
<ul><li>object variables are polymorphic — a variable can be assigned subclasses of its type</li> <li>no polymorphism exploit in arrays — all arrays remember the element type with which they were created (<code>new</code>ed)<div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Manager</span><span class="token punctuation">[</span><span class="token punctuation">]</span> managers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Manager</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token class-name">Employee</span><span class="token punctuation">[</span><span class="token punctuation">]</span> staff <span class="token operator">=</span> managers<span class="token punctuation">;</span> <span class="token comment">// OK</span>
staff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">&quot;Harry Hacker&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ArrayStoreException</span>
</code></pre></div></li></ul></li></ul></li> <li><p>method call</p> <ul><li>overriding resolution — according to function signatures, done by compiler
<ul><li>function signature
<ul><li>return type — return type is not a part of the signature (but is in JVM so bridge methods work)</li> <li>bridge method — when return another type, a bridge method is synthesized</li></ul></li></ul></li> <li>static binding — for <code>private</code>, <code>static</code>, <code>final</code> methods or constructors, done by compiler</li> <li>dynamic binding — JVM resolving the implicit parameter with method table lookup
<ul><li>method table — method table lists all method signatures and the actual methods to be called, computed by VM for each class in advance</li> <li>order of method table lookup — from actual type to superclasses to <code>Object</code></li> <li>overhead of dynamic binding — no need to use static binding to avoid the overhead, JIT does the inlining optimization</li></ul></li></ul></li> <li><p>casting</p> <ul><li>direct assign to more general — cast to more general, a subclass reference to a superclass variable, direct assign</li> <li>cast needed for more specific — cast to more specific, a superclass reference to a subclass variable, use the same syntax as primitive type cast, check at runtime
<ul><li>exception — <code>ClassCastException</code> when cannot cast</li> <li>check — use <code>instanceof</code> to check before casting</li> <li>cast range — can cast only within an inheritance hierarchy</li> <li>minimal usage — best to minimize the use of casts and the <code>instanceof</code> operator</li></ul></li></ul></li> <li><p>abstract class</p> <ul><li>no instance — cannot be instantiated, but can be super type</li> <li>abstract methods — any class can be tagged <code>abstract</code>, but not vice versa
<ul><li>can be none — abstract classes can have no abstract methods, abstract classes can have fields and concrete methods</li> <li>none in concrete class — a class with one or more <code>abstract</code> methods must itself be declared <code>abstract</code></li></ul></li></ul></li> <li><p><code>Object</code> — the cosmic superclass</p> <ul><li>for all reference type — only the values of primitive types (numbers, characters, and boolean values) are not objects</li> <li><code>boolean equals(Object otherObject)</code> — determines whether two object references are identical
<ul><li>override — template as below, need to override <code>hashCode</code> also if <code>equals</code> overriden<div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> otherObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// super.equals(other)</span>
    <span class="token comment">// a quick test to see if the objects are identical, may be unnecessary if covered in `super.equals(other)`</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> otherObject<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token comment">// must return false if the explicit parameter is null</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>otherObject <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token comment">// if the classes don't match, they can't be equal</span>
    <span class="token comment">// alternative — use instanceof and tagging final to allow objects of different subclasses to be equal to one another</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> otherObject<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token comment">// now we know otherObject is a non-null Employee</span>
    <span class="token class-name">Employee</span> other <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token punctuation">)</span> otherObject<span class="token punctuation">;</span>
    <span class="token comment">// test whether the fields have identical values</span>
    <span class="token keyword">return</span> name<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
        <span class="token operator">&amp;&amp;</span> salary <span class="token operator">==</span> other<span class="token punctuation">.</span>salary
        <span class="token operator">&amp;&amp;</span> hireDay<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>hireDay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li><code>native int hashCode()</code> — derived from the memory address, recommended to be compatible with <code>equals()</code></li> <li><code>String toString()</code> — <code>getClass().getName() + &quot;@&quot; + Integer.toHexString(hashCode());</code> <ul><li>for arrays — arrays will come up with something like <code>&quot;[I@1a46e30&quot;</code>, where <code>[I</code> denotes an array of integers </li></ul></li> <li><code>Class&lt;?&gt; getClass()</code></li> <li><code>protected Object clone()</code></li> <li><code>protected void finalize()</code> — deprecated in JDK 9, see <a href="#Classes-and-Modifiers">before</a></li> <li>concurrency related — see <a href="/notes-of-tan/backend/java/javaConcurrency.html">Concurrency</a></li> <li>methods in utility class <code>Objects</code></li></ul></li></ol> <h2 id="Interfaces-Lambdas-and-Inner-Classes"><a href="#Interfaces-Lambdas-and-Inner-Classes" class="header-anchor">#</a> Interfaces, Lambdas and Inner Classes</h2> <h3 id="Interfaces"><a href="#Interfaces" class="header-anchor">#</a> Interfaces</h3> <ol><li><p>interface</p> <ul><li>methods in interfaces
<ul><li>non-static methods — all methods are implicitly <code>abstract public</code>, redundancy is discouraged
<ul><li>when implementing — <code>public</code> still required when implementing</li></ul></li> <li>static methods — supported as of Java SE 8, need explicit access modifier</li> <li>prohibited modifiers — an interface method may not be declared with <code>protected</code> or package access, or with the modifiers <code>final</code>, <code>synchronized</code>, or <code>native</code></li></ul></li> <li>inner classes in interfaces — automatically <code>static public</code></li> <li>constant fields — implicitly <code>public static final</code>, automatically inherited when implementing</li> <li>no instance fields</li> <li><code>implements</code>, <code>SuperInterface.super</code> — examples below</li> <li>can be generic — <code>class Employee implements Comparable&lt;Employee&gt;</code></li> <li>use as super type — supports <code>instanceof</code>, <code>extend</code>, multiple inheritance
<ul><li>diamond problem — see below</li></ul></li></ul></li> <li><p>default methods</p> <ul><li><code>default</code> implementation<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Comparable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">default</span> <span class="token keyword">int</span> <span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">T</span> other<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment">// By default, all elements are the same</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><code>default</code> method conflict resolving — interface vs superclass vs another interface
<ul><li>superclasses take precedence — default methods are ignored if implemented in superclasses
<ul><li>no default <code>Object</code> methods — not possible to make a default method that redefines one of the methods in the <code>Object</code> class</li> <li>no abstract <code>Object</code> methods — redeclaring methods from the <code>Object</code> class do not make the methods abstract, no effect to function interfaces</li> <li>attach javadoc by <code>Object</code> methods — some interfaces redeclare <code>Object</code> methods in order to attach javadoc comments, like <code>Comparator</code></li></ul></li> <li>interface clash — if clashes, even only one of the methods is <code>default</code>, the method must be overriden
<ul><li><code>SuperInterface.super</code> — choose one when interface clash<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">interface</span> <span class="token class-name">Named</span> <span class="token punctuation">{</span> <span class="token keyword">default</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;_&quot;</span> <span class="token operator">+</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span> <span class="token keyword">default</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token keyword">implements</span> <span class="token class-name">Person</span><span class="token punctuation">,</span> <span class="token class-name">Named</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li></ul></li></ul></li> <li><p>companion class</p> <ul><li>used to place static methods — it has been common to place static methods in companion classes, like <code>Collection</code> / <code>Collections</code> or <code>Path</code> / <code>Paths</code></li> <li>used to implement some or all of methods of an interface — such as <code>Collection</code> / <code>AbstractCollection</code> or <code>MouseListener</code> / <code>MouseAdapter</code></li> <li><code>default</code> and <code>static</code> methods in interfaces — with Java SE 8, this technique of companion class is obsolete, as the support of default methods and static methods</li></ul></li> <li><p>some use of interface</p> <ul><li>callback — pass an object of a class implementing a callback interface, methods in the interface will be called when the event fires</li> <li>tagging interface — <code>Cloneable</code></li></ul></li></ol> <h4 id="Common-Interfaces"><a href="#Common-Interfaces" class="header-anchor">#</a> Common Interfaces</h4> <ol><li><p><code>interface Comparable&lt;T&gt;</code> — <code>int compareTo(T o)</code></p> <ul><li>overflow when implementing with subtraction — make sure absolute values of operands are at most <code>(Integer.MAX_VALUE - 1) / 2</code> <ul><li>otherwise use <code>Integer.compare()</code></li></ul></li> <li><code>equals()</code> compliance — strongly recommended (though not required) to comply with <code>equals()</code> <ul><li><code>BigDecimal</code> violates — <code>new BigDecimal(&quot;1.0&quot;).equals(new BigDecimal(&quot;1.00&quot;))</code> is <code>false</code> because the numbers differ in precision</li></ul></li> <li>associative — to make <code>x.compareTo(y)</code> compatible with <code>y.compareTo(x)</code>, start with below when implementing<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> other<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ClassCastException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li><p><code>interface java.util.Comparator&lt;T&gt;</code> — <code>int compare(T o1, T o2)</code></p> <ul><li>nature and reversed order
<ul><li><code>static &lt;T extends Comparable&lt;? super T&gt;&gt; Comparator&lt;T&gt; naturalOrder()</code></li> <li><code>static &lt;T extends Comparable&lt;? super T&gt;&gt; Comparator&lt;T&gt; reverseOrder()</code> — uses <code>Collections::reverseOrder</code> under the hood</li></ul></li> <li>key extract<div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// sort people by name</span>
<span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>people<span class="token punctuation">,</span> <span class="token class-name">Comparator</span><span class="token punctuation">.</span><span class="token function">comparing</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token operator">::</span><span class="token function">getName</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><code>static &lt;T,U extends Comparable&lt;? super U&gt;&gt; Comparator&lt;T&gt; comparing(Function&lt;? super T,? extends U&gt; keyExtractor)</code></li> <li><code>static &lt;T,U&gt; Comparator&lt;T&gt; comparing(Function&lt;? super T,? extends U&gt; keyExtractor, Comparator&lt;? super U&gt; keyComparator)</code></li> <li><code>static &lt;T&gt; Comparator&lt;T&gt; comparingDouble(ToDoubleFunction&lt;? super T&gt; keyExtractor)</code></li> <li><code>static &lt;T&gt; Comparator&lt;T&gt; comparingInt(ToIntFunction&lt;? super T&gt; keyExtractor)</code></li> <li><code>static &lt;T&gt; Comparator&lt;T&gt; comparingLong(ToLongFunction&lt;? super T&gt; keyExtractor)</code></li></ul></li> <li>comparator chaining<div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>people<span class="token punctuation">,</span> <span class="token class-name">Comparator</span>
    <span class="token punctuation">.</span><span class="token function">comparing</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token operator">::</span><span class="token function">getLastName</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">thenComparing</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token operator">::</span><span class="token function">getFirstName</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><code>default Comparator&lt;T&gt; thenComparing(Comparator&lt;? super T&gt; other)</code><br> <code>default &lt;U extends Comparable&lt;? super U&gt;&gt; Comparator&lt;T&gt; thenComparing(Function&lt;? super T,? extends U&gt; keyExtractor)</code><br> <code>default &lt;U&gt; Comparator&lt;T&gt; thenComparing(Function&lt;? super T,? extends U&gt; keyExtractor, Comparator&lt;? super U&gt; keyComparator)</code></li> <li><code>default Comparator&lt;T&gt; thenComparingType(ToTypeFunction&lt;? super T&gt; keyExtractor)</code> — <code>type</code> for <code>int</code>, <code>double</code> and <code>long</code></li> <li><code>default Comparator&lt;T&gt; reversed()</code> — uses <code>Collections::reverseOrder</code> under the hood</li></ul></li> <li>comparing <code>null</code> <ul><li><code>static &lt;T&gt; Comparator&lt;T&gt; nullsFirst(Comparator&lt;? super T&gt; comparator)</code></li> <li><code>static &lt;T&gt; Comparator&lt;T&gt; nullsLast(Comparator&lt;? super T&gt; comparator)</code></li></ul></li></ul></li> <li><p><code>interface Cloneable</code></p> <ul><li>mark interface — serves as a tag, a checked <code>CloneNotSupportedException</code> if an object requests cloning but does not implement that interface</li> <li>make a class cloneable — implement this interface, redefine <code>clone</code> to be <code>public</code> <ul><li><code>Object::clone</code> — protected, and does a shallow copy</li> <li>use <code>Object::clone</code> — <code>(T) super.clone()</code></li></ul></li> <li>return <code>Object</code> by convention — Up to Java SE 1.4, the clone method always had return type <code>Object</code>, but now the correct return type can be specified
<ul><li>inconsistency — <code>HashMap::clone</code> and <code>ArrayList::clone</code> etc. return <code>Object</code>, whereas <code>int[]::clone</code> and <code>ArrayDeque::clone</code> etc. return specific type</li></ul></li></ul></li></ol> <h3 id="Lambdas"><a href="#Lambdas" class="header-anchor">#</a> Lambdas</h3> <ol><li><p>closure</p> <ul><li>effectively final — any captured variable in a lambda expression must be effectively final: no difference if declared <code>final</code><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ActionListener</span> listener <span class="token operator">=</span> event <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token string">&quot;: &quot;</span> <span class="token operator">+</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Error: Cannot refer to changing i</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">new</span> <span class="token class-name">Timer</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> listener<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>no mutation outside — illegal to refer to a variable in a lambda expression that is mutated outside</li> <li>no mutation inside — cannot mutate captured value</li> <li>access mutable data — use an array of length 1</li></ul></li> <li>no block variable shadowing — illegal to declare a parameter or a local variable in the lambda that has the same name as a local variable</li> <li>block scope — the same scope as a nested block</li> <li>same <code>this</code> — <code>this</code> is the same as what outside the lambda</li> <li>number of instantiations — only one instantiation inside loops when no closure<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token class-name">IntUnaryOperator</span> oper <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> opCounter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">lambdaTest</span><span class="token punctuation">(</span><span class="token class-name">IntUnaryOperator</span> op<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>op <span class="token operator">!=</span> oper<span class="token punctuation">)</span> <span class="token operator">++</span>opCounter<span class="token punctuation">;</span>
    oper <span class="token operator">=</span> op<span class="token punctuation">;</span>
    <span class="token keyword">return</span> op<span class="token punctuation">.</span><span class="token function">applyAsInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">lambdaTest</span><span class="token punctuation">(</span>j <span class="token operator">-&gt;</span> j <span class="token operator">*</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>opCounter<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
<span class="token punctuation">}</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">lambdaTest</span><span class="token punctuation">(</span>j <span class="token operator">-&gt;</span> j <span class="token operator">*</span> j <span class="token operator">*</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>opCounter<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 100</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li><p>lambda expression syntax</p> <ul><li>inline<div class="language-java extra-class"><pre class="language-java"><code><span class="token punctuation">(</span><span class="token class-name">String</span> first<span class="token punctuation">,</span> <span class="token class-name">String</span> second<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> first<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> second<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li>block with explicit <code>return</code><div class="language-java extra-class"><pre class="language-java"><code><span class="token punctuation">(</span><span class="token class-name">String</span> first<span class="token punctuation">,</span> <span class="token class-name">String</span> second<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>first<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> second<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>first<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> second<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li>type inference<div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> comp <span class="token operator">=</span> <span class="token punctuation">(</span>first<span class="token punctuation">,</span> second<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> first<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> second<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li>type inference without parentheses<div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">ActionListener</span> listener <span class="token operator">=</span> event <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;The time is &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>&quot;<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li>inferred return type — return type is always inferred, cannot be specified</li></ul></li> <li><p>functional interface — an interface with a single abstract method, like <code>Comparator&lt;T&gt;</code></p> <ul><li>for conversion from lambdas — conversion to a functional interface is the only function for lambdas</li> <li>object instance used behind the scenes — methods like <code>Arrays::sort</code> receives an object of some class that implements the interface, lambda is executed when invoking the method of that interface</li> <li><code>@FunctionalInterface</code> — optional annotation</li> <li>lambda expression holders (also function interface) — see <a href="#Common-Functional-Interfaces">Common Functional Interfaces</a> for <code>java.util.function</code></li></ul></li> <li><p>method reference — use as lambdas</p> <div class="language-java extra-class"><pre class="language-java"><code>object<span class="token operator">::</span><span class="token function">instanceMethod</span>
<span class="token keyword">this</span><span class="token operator">::</span><span class="token function">instanceMethod</span>
<span class="token keyword">super</span><span class="token operator">::</span><span class="token function">instanceMethod</span> <span class="token comment">// uses `this` as the target and invokes the superclass version of the given method</span>
<span class="token class-name">Class</span><span class="token operator">::</span><span class="token function">staticMethod</span>
<span class="token class-name">Class</span><span class="token operator">::</span><span class="token function">instanceMethod</span> <span class="token comment">// the implicit parameter becomes explicit</span>
<span class="token class-name">Class</span><span class="token operator">::</span><span class="token keyword">new</span> <span class="token comment">// constructor reference</span>
<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">::</span><span class="token keyword">new</span>
</code></pre></div><ul><li>object instance used behind the scenes — turned into instances of functional interfaces like lambdas</li> <li><code>int[]::new</code> — <code>new T[n]</code> is illegal, so libary designers use this syntax to mitigate<div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> people <span class="token operator">=</span> stream<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Person</span><span class="token punctuation">[</span><span class="token punctuation">]</span> people <span class="token operator">=</span> stream<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">::</span><span class="token keyword">new</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li></ol> <h4 id="Common-Functional-Interfaces"><a href="#Common-Functional-Interfaces" class="header-anchor">#</a> Common Functional Interfaces</h4> <ol><li><p><code>java.util.function</code> package, all <code>@FunctionalInterface</code></p></li> <li><p><code>java.util.function.Function&lt;T, R&gt;</code> — <code>R apply(T t)</code></p> <ul><li><code>static &lt;T&gt; Function&lt;T,T&gt; identity()</code></li> <li>chaining
<ul><li><code>default &lt;V&gt; Function&lt;T,V&gt; andThen(Function&lt;? super R,? extends V&gt; after)</code></li> <li><code>default &lt;V&gt; Function&lt;V,R&gt; compose(Function&lt;? super V,? extends T&gt; before)</code></li></ul></li> <li>variants
<ul><li><code>java.util.function.DoubleFunction&lt;R&gt;</code> — <code>R apply(double value)</code></li> <li><code>java.util.function.DoubleToIntFunction</code></li> <li><code>java.util.function.DoubleToLongFunction</code></li> <li><code>java.util.function.IntFunction&lt;R&gt;</code></li> <li><code>java.util.function.IntToDoubleFunction</code></li> <li><code>java.util.function.IntToLongFunction</code></li> <li><code>java.util.function.LongFunction&lt;R&gt;</code></li> <li><code>java.util.function.LongToDoubleFunction</code></li> <li><code>java.util.function.LongToIntFunction</code></li> <li><code>java.util.function.ToDoubleFunction&lt;T&gt;</code></li> <li><code>java.util.function.ToIntFunction&lt;T&gt;</code></li> <li><code>java.util.function.ToLongFunction&lt;T&gt;</code></li></ul></li> <li>variants with two parameters
<ul><li><code>java.util.function.BiFunction&lt;T,U,R&gt;</code> — <code>R apply(T t, U u)</code></li> <li><code>java.util.function.ToDoubleBiFunction&lt;T,U&gt;</code></li> <li><code>java.util.function.ToIntBiFunction&lt;T,U&gt;</code></li> <li><code>java.util.function.ToLongBiFunction&lt;T,U&gt;</code></li></ul></li></ul></li> <li><p>operator — <code>Function</code> with type parameters of the same primitive type</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@FunctionalInterface</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UnaryOperator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span>
<span class="token keyword">extends</span> <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>unary
<ul><li><code>java.util.function.UnaryOperator&lt;T&gt;</code> <ul><li><code>static &lt;T&gt; UnaryOperator&lt;T&gt; identity()</code></li></ul></li> <li><code>java.util.function.DoubleUnaryOperator</code></li> <li><code>java.util.function.IntUnaryOperator</code></li> <li><code>java.util.function.LongUnaryOperator</code></li></ul></li> <li>binary
<ul><li><code>java.util.function.BinaryOperator&lt;T&gt;</code> <ul><li><code>static &lt;T&gt; BinaryOperator&lt;T&gt; maxBy(Comparator&lt;? super T&gt; comparator)</code></li> <li><code>static &lt;T&gt; BinaryOperator&lt;T&gt; minBy(Comparator&lt;? super T&gt; comparator)</code></li></ul></li> <li><code>java.util.function.DoubleBinaryOperator</code> — <code>double applyAsDouble(double left, double right)</code></li> <li><code>java.util.function.IntBinaryOperator</code></li> <li><code>java.util.function.LongBinaryOperator</code></li></ul></li></ul></li> <li><p><code>java.util.function.Supplier&lt;T&gt;</code> — <code>T get()</code></p> <ul><li>variants
<ul><li><code>java.util.function.BooleanSupplier</code> — <code>boolean getAsBoolean()</code></li> <li><code>java.util.function.DoubleSupplier</code></li> <li><code>java.util.function.IntSupplier</code></li> <li><code>java.util.function.LongSupplier</code></li></ul></li></ul></li> <li><p><code>java.util.function.Consumer&lt;T&gt;</code> — <code>void accept(T t)</code></p> <ul><li><code>default Consumer&lt;T&gt; andThen(Consumer&lt;? super T&gt; after)</code> — chaining<div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// default implementation</span>
<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span> t<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span> <span class="token function">accept</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span> after<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li> <li>variants
<ul><li><code>java.util.function.DoubleConsumer</code> — <code>void accept(double value)</code></li> <li><code>java.util.function.IntConsumer</code></li> <li><code>java.util.function.LongConsumer</code></li></ul></li> <li>variants with two parameters
<ul><li><code>java.util.function.BiConsumer&lt;T, U&gt;</code> — <code>void accept(T t, U u)</code></li> <li><code>java.util.function.ObjDoubleConsumer&lt;T&gt;</code></li> <li><code>java.util.function.ObjIntConsumer&lt;T&gt;</code></li> <li><code>java.util.function.ObjLongConsumer&lt;T&gt;</code></li></ul></li></ul></li> <li><p><code>java.util.function.Predicate&lt;T&gt;</code> — <code>boolean test(T t)</code></p> <ul><li><code>static &lt;T&gt; Predicate&lt;T&gt; isEqual(Object targetRef)</code></li> <li>chaining
<ul><li><code>default Predicate&lt;T&gt; and(Predicate&lt;? super T&gt; other)</code></li> <li><code>default Predicate&lt;T&gt; negate()</code></li> <li><code>default Predicate&lt;T&gt; or(Predicate&lt;? super T&gt; other)</code></li></ul></li> <li>variants
<ul><li><code>java.util.function.DoublePredicate</code></li> <li><code>java.util.function.IntPredicate</code></li> <li><code>java.util.function.LongPredicate</code></li> <li><code>java.util.function.BiPredicate&lt;T,U&gt;</code></li></ul></li></ul></li></ol> <h3 id="Inner-Class"><a href="#Inner-Class" class="header-anchor">#</a> Inner Class</h3> <ol><li><p>inner class</p> <ul><li><code>OuterClass.this</code> — explicit reference to the outer class
<ul><li>passed as implicit parameter to inner class constructors</li></ul></li> <li>implicit reference — can access the data from the scope in which they are defined
<ul><li>synthesized constructor parameter for implicit reference — the compiler modifies all inner class constructors, adding a parameter for the outer class reference</li></ul></li> <li>constructing inner classes — <code>new</code> keyword changes for implicit reference
<ul><li>inside outer class — <code>this.new</code> or alternatively <code>new</code></li> <li>outside outer class — <code>outerObj.new</code></li></ul></li> <li>access control — can be hidden from other classes in the same package
<ul><li>only inner classes can be private — regular classes always have either package or public visibility</li> <li><code>private</code> accessible for each other — between the outer class and inner classes</li></ul></li> <li>refer to inner class outside the outer class — <code>OuterClass.InnerClass</code></li></ul></li> <li><p>inner class limits</p> <ul><li>static fields — must be <code>final</code></li> <li>static methods — cannot have static methods</li></ul></li> <li><p>inner class after compilation or at runtime — synthesized regular classes</p> <ul><li><code>Outer$Inner</code> class — inner classes are translated into regular class files with <code>$</code> (dollar signs) delimiting outer and inner class names
<ul><li>compared to regular classes — more access privileges to the outer class, like private fields</li></ul></li> <li>synthesized outer class reference — inner class has a <code>final</code> <code>this$0</code> field for reference to outer class generated by compiler</li> <li>private inner classes — JVM does not support private classes, so the compiler produces a package-visible class with a private constructor, and a second package-visible constructor that calls the private one<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">TalkingClock</span>$<span class="token class-name">TimePrinter</span><span class="token punctuation">(</span><span class="token class-name">TalkingClock</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">TalkingClock</span>$<span class="token class-name">TimePrinter</span><span class="token punctuation">(</span><span class="token class-name">TalkingClock</span><span class="token punctuation">,</span> <span class="token class-name">TalkingClock</span>$<span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// the last parameter type is synthesized solely to distinguish this constructor from others</span>
<span class="token keyword">new</span> <span class="token class-name">TalkingClock</span>$<span class="token class-name">TimePrinter</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// actual call in outer class</span>
</code></pre></div></li> <li>mechanism for more privileged access to outer class — synthesized outer class backdoor method
<ul><li>backdoor method — outer class generates a package accessible static <code>access$0(OuterClass outer)</code> method (method name can vary slightly), for inner class, outer class private field access is translated to backdoor method call</li> <li>vulnerability — the generated backdoor method name is not legal in source code, but can be exploited by build or modify a class file</li></ul></li> <li>transparent to JVM — the virtual machine does not have any special knowledge about inner classes</li> <li>verify by inspecting class files — use <code>javap -p</code> to verify</li></ul></li> <li><p>local inner class — class locally in a single method</p> <ul><li>no access modifier — never declared with an access specifier</li> <li>restricted scope — scope is always restricted to the block being declared</li> <li>effectively final closure — can access effectively final local variables
<ul><li>as final fields — behind the scenes stored as a final field of inner class, and spawned to constructor for initialization</li></ul></li> <li>anonymous inner subclass<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">new</span> <span class="token class-name">SuperType</span><span class="token punctuation">(</span>construction parameters<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// inner class methods and data</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>implementing or extending — <code>SuperType</code> can be an interface or a class, the inner class implements that interface or extends the class
<ul><li>a different subclass — take care that <code>equals()</code> checking <code>getClass() == otherObject.getClass()</code> may fail</li></ul></li> <li>no constructor redefining — anonymity cannot have constructors — the name of a constructor must be the same as the name of a class</li> <li>use case
<ul><li>double brace initialization for <code>ArrayList</code><div class="language-java extra-class"><pre class="language-java"><code><span class="token function">invite</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;Harry&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;Tony&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li>get the class from static methods, alternative to <code>T.class</code><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEnclosingClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li></ul></li></ul></li> <li><p>static inner class</p> <ul><li>static — do not have a outer class reference, can have static fields and methods</li> <li>use case
<ul><li>enums are static inner classes</li> <li>use in outer static methods — must be declared static if needed in a outer class static method</li> <li>return type — can be used for holder for a method to return multiple values</li></ul></li> <li>the only static classes — only inner classes can be declared static</li> <li>implicitly static
<ul><li>inner interfaces are implicitly <code>static</code></li> <li>inner classes inside interfaces are automatically <code>static public</code></li></ul></li></ul></li></ol> <h2 id="Reflection"><a href="#Reflection" class="header-anchor">#</a> Reflection</h2> <ol><li><p>runtime type identification — used by VM for method resolution</p> <ul><li><code>Object::getClass</code></li> <li><code>Class::forName</code></li> <li><code>T.class</code> if <code>T</code> is any Java type (or <code>void.class</code>)</li> <li>type capturing — use <code>Class&lt;T&gt;</code> as a parameter for type match, when called with a class object, the type parameter <code>T</code> will be matched</li></ul></li> <li><p><code>interface java.lang.reflect.Type</code> — super interface for all types, implemented or extended by <code>Class&lt;T&gt;</code>, <code>GenericArrayType</code>, <code>ParameterizedType</code>, <code>TypeVariable&lt;D&gt;</code>, <code>WildcardType</code></p> <ul><li><code>default String getTypeName()</code></li> <li>generics reflection methods — in implementing classes or sub-Interfaces</li></ul></li> <li><p><code>interface java.lang.reflect.AnnotatedElement</code> — represents an annotated element with methods getting annotations</p></li> <li><p><code>java.lang.reflect.GenericDeclaration</code> — entities that declare type variables</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">GenericDeclaration</span>
<span class="token keyword">extends</span> <span class="token class-name">AnnotatedElement</span>
</code></pre></div><ul><li><code>TypeVariable&lt;?&gt;[] getTypeParameters()</code></li></ul></li> <li><p><code>Class</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">extends</span> <span class="token class-name">Object</span>
<span class="token keyword">implements</span> <span class="token class-name">Serializable</span><span class="token punctuation">,</span> <span class="token class-name">GenericDeclaration</span><span class="token punctuation">,</span> <span class="token class-name">Type</span><span class="token punctuation">,</span> <span class="token class-name">AnnotatedElement</span>
</code></pre></div><ul><li>reflection
<ul><li><code>String getName()</code></li> <li><code>String getTypeName()</code></li> <li><code>String toString()</code></li> <li><code>Class&lt;?&gt; getComponentType()</code> — type of elements in an array, <code>null</code> if <code>this</code> is not an array</li> <li><code>ClassLoader getClassLoader()</code></li> <li><code>T[] getEnumConstants()</code></li> <li><code>Class&lt;? super T&gt; getSuperclass()</code></li></ul></li> <li>instance creation
<ul><li><code>T newInstance()</code></li> <li><code>T cast(Object obj) throws ClassCastException</code></li></ul></li> <li>method reflection — from this class and superclasses, <code>declared-</code> only for this class
<ul><li><code>Field[] getFields()</code></li> <li><code>Field getField(String name)</code></li> <li><code>Field[] getDeclaredFields()</code></li> <li><code>Field getDeclaredField(String name)</code></li> <li><code>Method[] getMethods()</code></li> <li><code>Method getMethod(String name, Class&lt;?&gt;... parameterTypes)</code></li> <li><code>Method[] getDeclaredMethods()</code></li> <li><code>Method getDeclaredMethod(String name, Class&lt;?&gt;... parameterTypes)</code></li> <li><code>Constructor[] getConstructors()</code></li> <li><code>Constructor&lt;T&gt; getConstructor(Class&lt;?&gt;... parameterTypes)</code></li> <li><code>Constructor[] getDeclaredConstructors()</code></li> <li><code>Constructor&lt;T&gt; getDeclaredConstructor(Class&lt;?&gt;... parameterTypes)</code></li></ul></li> <li>inner class and outer class
<ul><li><code>Class&lt;?&gt;[] getClasses()</code></li> <li><code>Class&lt;?&gt; getEnclosingClass()</code></li></ul></li> <li>generics
<ul><li><code>Type[] getGenericInterfaces()</code></li> <li><code>Type getGenericSuperclass()</code></li> <li><code>TypeVariable&lt;Class&lt;T&gt;&gt;[] getTypeParameters()</code></li></ul></li> <li>get resources, delegating to class loader
<ul><li><code>URL getResource(String name)</code></li> <li><code>InputStream getResourceAsStream(String name)</code></li></ul></li></ul></li> <li><p><code>java.lang.reflect.Field</code><br> <code>java.lang.reflect.Method</code><br> <code>java.lang.reflect.Constructor</code></p> <ul><li><code>Class&lt;?&gt; getDeclaringClass()</code></li> <li><code>Class&lt;?&gt;[] getExceptionTypes()</code> (<code>Constructor</code> and <code>Method</code>)</li> <li><code>Class&lt;?&gt;[] getParameterTypes()</code> (<code>Constructor</code> and <code>Method</code>)</li> <li><code>int getModifiers()</code></li> <li><code>String getName()</code></li> <li>inherited from <code>java.lang.reflect.AccessibleObject</code> <ul><li><code>boolean isAccessible()</code></li> <li><code>void setAccessible()</code></li></ul></li></ul></li> <li><p><code>java.lang.reflect.Constructor</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Constructor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span>
<span class="token keyword">extends</span> <span class="token class-name">Executable</span>
</code></pre></div><ul><li><code>T newInstance(Object... initargs)</code></li></ul></li> <li><p><code>java.lang.reflect.Method</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Method</span>
<span class="token keyword">extends</span> <span class="token class-name">Executable</span>
</code></pre></div><ul><li><code>Object invoke(Object obj, Object... args)</code> <ul><li>For a static method, the first parameter is ignored, use <code>null</code></li> <li>slow and as last resort</li></ul></li> <li><code>Class&lt;?&gt; getReturnType()</code></li> <li>Generics
<ul><li><code>TypeVariable[] getTypeParameters()</code></li> <li><code>Type getGenericReturnType()</code></li> <li><code>Type[] getGenericParameterTypes()</code></li></ul></li></ul></li> <li><p><code>java.lang.reflect.Field</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Field</span>
<span class="token keyword">extends</span> <span class="token class-name">AccessibleObject</span>
<span class="token keyword">implements</span> <span class="token class-name">Member</span>
</code></pre></div><ul><li><code>Object get(Object obj)</code> — <code>obj.field</code><br> <code>type getType(Object obj)</code> — for primitive</li> <li><code>void set(Object obj, Object value)</code><br> <code>type setType(Object obj, type value)</code></li></ul></li> <li><p><code>java.lang.reflect.Modifier</code></p> <ul><li><code>static String toString(int mod)</code></li> <li><code>static boolean isAbstract(int mod)</code></li> <li><code>static boolean isFinal(int mod)</code></li> <li><code>static boolean isInterface(int mod)</code></li> <li><code>static boolean isNative(int mod)</code></li> <li><code>static boolean isPrivate(int mod)</code></li> <li><code>static boolean isProtected(int mod)</code></li> <li><code>static boolean isPublic(int mod)</code></li> <li><code>static boolean isStatic(int mod)</code></li> <li><code>static boolean isStrict(int mod)</code></li> <li><code>static boolean isSynchronized(int mod)</code></li> <li><code>static boolean isVolatile(int mod)</code></li></ul></li> <li><p><code>java.lang.reflect.Array</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Array</span> <span class="token keyword">extends</span> <span class="token class-name">Object</span>
</code></pre></div><ul><li><code>static Object newInstance(Class&lt;?&gt; componentType, int length)</code><br> <code>static Object newInstance(Class&lt;?&gt; componentType, int... dimensions)</code> <ul><li>in coordination with <code>ClassObj.getComponentType()</code></li> <li><code>type[]</code> can be converted to an <code>Object</code>, but not <code>Object[]</code></li></ul></li> <li><code>static int getLength(Object array)</code></li> <li><code>static void set(Object array)</code></li> <li><code>static Object get(Object array)</code></li> <li><code>static type getType(Object array)</code></li></ul></li> <li><p><code>Package</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Package</span> <span class="token keyword">extends</span> <span class="token class-name">Object</span>
<span class="token keyword">implements</span> <span class="token class-name">AnnotatedElement</span>
</code></pre></div></li></ol> <h3 id="Proxy"><a href="#Proxy" class="header-anchor">#</a> Proxy</h3> <ol><li><p>proxies</p> <ul><li>usage — at runtime, create new classes that implement given interfaces, with a method invocation handler</li> <li>proxy class definition
<ul><li>runtime defined class — proxy objects are of classes defined at runtime with names such as <code>$Proxy0</code></li> <li>modifiers and inheritance — all proxies are <code>public final</code> and extends <code>Proxy</code></li> <li>cached — only one proxy class for a particular class loader and ordered set of interfaces</li> <li>package — default package if given interfaces all public, else belongs to the package of given non-public interfaces</li></ul></li> <li>proxying — all proxy classes override the <code>toString()</code>, <code>equals()</code>, and <code>hashCode()</code>, and given interface methods with <code>InvocationHandler::invoke</code> <ul><li>other methods in <code>Object</code> are untouched</li></ul></li></ul></li> <li><p><code>interface java.lang.reflect.InvocationHandler</code> — invocation handlers</p> <ul><li><code>public Object invoke(Object proxy, Method method, Object[] args) throws Throwable</code></li> <li>additional data is stored in the invocation handler</li></ul></li> <li><p><code>java.lang.reflect.Proxy</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Proxy</span> <span class="token keyword">extends</span> <span class="token class-name">Object</span>
<span class="token keyword">implements</span> <span class="token class-name">Serializable</span>
</code></pre></div><ul><li>creation
<ul><li><code>static Object newProxyInstance(ClassLoader loader, Class&lt;?&gt;[] interfaces, InvocationHandler h)</code></li> <li><code>static Class&lt;?&gt; getProxyClass(ClassLoader loader, Class&lt;?&gt;... interfaces)</code></li></ul></li> <li><code>static InvocationHandler getInvocationHandler(Object proxy)</code></li> <li><code>static boolean isProxyClass(Class&lt;?&gt; cl)</code></li></ul></li> <li><p>use example</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProxyTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> elems <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> clz <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token class-name">Comparable</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">setAll</span><span class="token punctuation">(</span>elems<span class="token punctuation">,</span> i <span class="token operator">-&gt;</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> clz<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">TraceHandler</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">binarySearch</span><span class="token punctuation">(</span>elems<span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token class-name">ThreadLocalRandom</span><span class="token punctuation">.</span><span class="token function">current</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>elements<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">TraceHandler</span> <span class="token keyword">implements</span> <span class="token class-name">InvocationHandler</span> <span class="token punctuation">{</span>
   <span class="token keyword">private</span> <span class="token class-name">Object</span> target<span class="token punctuation">;</span>
   <span class="token keyword">public</span> <span class="token class-name">TraceHandler</span><span class="token punctuation">(</span><span class="token class-name">Object</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      target <span class="token operator">=</span> t<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> m<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
      <span class="token comment">// print implicit argument</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// print method name</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span> <span class="token operator">+</span> m<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;(&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// print explicit arguments</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>args <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> args<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> args<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;, &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// invoke actual method</span>
      <span class="token keyword">return</span> m<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <h2 id="Error-Handling"><a href="#Error-Handling" class="header-anchor">#</a> Error Handling</h2> <h3 id="Debugging"><a href="#Debugging" class="header-anchor">#</a> Debugging</h3> <ol><li><p>debugging</p> <ul><li>use debugger</li> <li>test with main method, or unit test tools</li> <li>print or log</li></ul></li> <li><p>print or log</p> <ul><li>debug by print concatenated or formatted string</li> <li>logging proxy — anonymous inner class overriding methods of interest with logger</li> <li>stack trace — <code>Throwable::printStackTrace</code> and rethrow, or <code>Thread.dumpStack()</code> <ul><li>capture string instead of printing to <code>System.err</code><div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">StringWriter</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Throwable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PrintWriter</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> description <span class="token operator">=</span> out<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li>change handler for uncaught exceptions<div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">setDefaultUncaughtExceptionHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token class-name">UncaughtExceptionHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">uncaughtException</span><span class="token punctuation">(</span><span class="token class-name">Thread</span> t<span class="token punctuation">,</span> <span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* logging... */</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li></ul></li> <li><p>CLI options related to debugging — tbd</p> <ul><li><code>ctrl</code> + <code>\</code> — get thread dump when the program hangs??</li> <li><code>java</code> <ul><li>use <code>-verbose</code> when launching JVM for diagnosing class path problems</li> <li>use <code>Xprof</code> for profiling, note that support was removed in 10.0</li> <li><code>-XX:+HeapDumpOnOutOfMemoryError</code></li></ul></li> <li>use <code>-Xlint:all</code> when <code>javac</code></li> <li>use <code>jconsole</code> to track memory consumption, thread usage, class loading</li> <li><code>jmap</code> and <code>jhat</code> (<code>jhat</code> removed in JDK 9) — <code>jmap</code> to get a heap dump and <code>jhat</code> to examine<div class="language-java extra-class"><pre class="language-java"><code>jmap <span class="token operator">-</span>dump<span class="token operator">:</span>format<span class="token operator">=</span>b<span class="token punctuation">,</span>file<span class="token operator">=</span>dumpFileName processID
jhat dumpFileName
</code></pre></div><ul><li>at <code>localhost:7000</code></li></ul></li> <li><code>jstat</code></li> <li><code>jcmd</code></li> <li><code>hprof</code></li> <li><code>jps</code></li> <li><code>jstack</code></li> <li><code>syslog</code></li></ul></li></ol> <h3 id="Exceptions"><a href="#Exceptions" class="header-anchor">#</a> Exceptions</h3> <ol><li><p>unchecked exceptions and checked exceptions</p> <ul><li>unchecked — any exception that derives from the class <code>Error</code> or the class <code>RuntimeException</code> an unchecked exception</li> <li>checked — All other exceptions are called checked exceptions, including <code>Exception</code></li> <li>why called checked — The compiler checks that you provide exception handlers for all checked exceptions</li></ul></li> <li><p><code>Throwable</code> — the superclass of all errors and exceptions, other objects cannot be thrown</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Throwable</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span>
</code></pre></div><ul><li>constructors
<ul><li><code>Throwable()</code></li> <li><code>Throwable(String message)</code></li> <li><code>Throwable(String message, Throwable cause)</code></li> <li><code>protected Throwable(String message, Throwable cause, boolean enableSuppression, boolean writableStackTrace)</code></li> <li><code>Throwable(Throwable cause)</code></li></ul></li> <li>stack trace
<ul><li><code>void printStackTrace()</code><br> <code>void printStackTrace(PrintStream s)</code><br> <code>void printStackTrace(PrintWriter s)</code></li> <li><code>void setStackTrace(StackTraceElement[] stackTrace)</code></li> <li><code>StackTraceElement[] getStackTrace()</code></li> <li><code>Throwable fillInStackTrace()</code></li></ul></li> <li>error message
<ul><li><code>String getMessage()</code></li> <li><code>String getLocalizedMessage()</code> — for overriding, defaults to <code>getMessage()</code></li> <li><code>String toString()</code> — class name, and message if applicable</li></ul></li> <li>wrapping
<ul><li><code>Throwable initCause(Throwable cause)</code></li> <li><code>Throwable getCause()</code></li></ul></li> <li>suppress
<ul><li><code>void addSuppressed(Throwable exception)</code></li> <li><code>Throwable[] getSuppressed()</code></li></ul></li> <li>subclasses
<ul><li><code>Error</code></li> <li><code>Exception</code></li></ul></li></ul></li> <li><p><code>Error</code> — internal errors and resource exhaustion situations, not expected to throw by user</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Error</span> <span class="token keyword">extends</span> <span class="token class-name">Throwable</span>
</code></pre></div></li> <li><p><code>Exception</code> and its hierarchy</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Exception</span> <span class="token keyword">extends</span> <span class="token class-name">Throwable</span>
</code></pre></div><ul><li><code>CloneNotSupportedException</code></li> <li><code>InterruptedException</code></li> <li><code>ReflectiveOperationException</code> <ul><li><code>ClassNotFoundException</code></li> <li><code>IllegalAccessException</code></li> <li><code>InstantiationException</code></li> <li><code>NoSuchFieldException</code></li> <li><code>NoSuchMethodException</code></li></ul></li> <li><code>RuntimeException</code> <ul><li><code>ArithmeticException</code></li> <li><code>ArrayStoreException</code></li> <li><code>ClassCastException</code></li> <li><code>EnumConstantNotPresentException</code></li> <li><code>IllegalArgumentException</code> <ul><li><code>IllegalThreadStateException</code></li> <li><code>NumberFormatException</code></li></ul></li> <li><code>IllegalMonitorStateException</code></li> <li><code>IllegalStateException</code></li> <li><code>IndexOutOfBoundsException</code> <ul><li><code>ArrayIndexOutOfBoundsException</code></li> <li><code>StringIndexOutOfBoundsException</code></li></ul></li> <li><code>NegativeArraySizeException</code></li> <li><code>NullPointerException</code></li> <li><code>SecurityException</code></li> <li><code>TypeNotPresentException</code></li> <li><code>UnsupportedOperationException</code></li></ul></li></ul></li> <li><p><code>StackTraceElement</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">StackTraceElement</span> <span class="token keyword">extends</span> <span class="token class-name">Object</span>
<span class="token keyword">implements</span> <span class="token class-name">Serializable</span>
</code></pre></div><ul><li>creation
<ul><li><code>StackTraceElement(String declaringClass, String methodName, String fileName, int lineNumber)</code></li> <li><code>Throwable::getStackTrace</code></li> <li><code>Thread::getStackTrace</code></li> <li><code>Thread.getAllStackTraces()</code></li></ul></li> <li>stack info
<ul><li><code>String getClassName()</code></li> <li><code>String getFileName()</code></li> <li><code>int getLineNumber()</code></li> <li><code>String getMethodName()</code></li></ul></li></ul></li></ol> <h3 id="Exception-Handling"><a href="#Exception-Handling" class="header-anchor">#</a> Exception Handling</h3> <ol><li><p>exception specification — declare checked exceptions</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// modifiers return_type method_name(parameters) throws Exception1, Exception2</span>
<span class="token comment">// java.io.FileInputStream</span>
<span class="token keyword">public</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">FileNotFoundException</span>
</code></pre></div><ul><li>when to declare
<ul><li>nested method call — when calling a method that threatens to throw a checked exception</li> <li><code>throw</code> checked exceptions spontaneously — check exceptions can be thrown only when declared by the method</li></ul></li> <li>if not declared — compiling error if a method fails to faithfully declare all checked exceptions or handle them</li> <li>if caught — no need for <code>throws</code></li> <li>when overriding a method
<ul><li>more specific exceptions or not at all — exception specification cannot be more general; OK to throw more specific exceptions, or not to throw any exceptions in the subclass method</li> <li>none if none in superclass — if the superclass method throws no checked exception at all, neither can the subclass</li></ul></li></ul></li> <li><p><code>try catch</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// statements that might throw exceptions</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">FileNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// optionally final in parameter</span>
    <span class="token comment">// emergency action for missing files</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">UnknownHostException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// emergency action for unknown hosts</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// emergency action for all other I/O problems</span>
<span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    <span class="token comment">// close resources</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>multiple exception types — only needed when catching exception types that are not subclasses of one another<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">FileNotFoundException</span> <span class="token operator">|</span> <span class="token class-name">UnknownHostException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// emergency action for missing files and unknown hosts</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>implicit <code>final</code> — the exception variable is implicitly <code>final</code> when multiple exception types</li></ul></li> <li>rethrow — <code>throw</code> in <code>catch</code> block
<ul><li>exception wrapping — use <code>Throwable::initCause</code> to throw as another wrapped type and <code>Throwable::getCause</code> for original failure</li> <li>bypass exception specification limit — rethrow a wrapped <code>RuntimeException</code> if a method cannot throw checked exception
<ul><li>for <code>IOException</code> — <code>java.io.UncheckedIOException</code> is designed to wrap <code>IOException</code></li></ul></li> <li>use generics to make checked exceptions unchecked, see <a href="#Generics">Generics</a></li></ul></li> <li>smart narrowing — when rethrow any exception<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateRecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// access the database</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>level<span class="token punctuation">,</span> message<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>example above — compiler now tracks the fact that <code>e</code> originates from the <code>try</code> block, it is valid to declare the enclosing method as throws <code>SQLException</code></li> <li>smart narrowing conditions
<ul><li>only checked exceptions — provided that the only checked exceptions in that block are <code>SQLException</code> instances</li> <li><code>final</code> <code>e</code> — and provided that <code>e</code> is not changed in the catch block</li></ul></li></ul></li></ul></li> <li><p><code>finally</code> — always executed, can be used without <code>catch</code></p> <ul><li>order — executes before the method return, if <code>return</code> used before <code>finally</code></li> <li>mask <code>return</code> and exceptions
<ul><li><code>return</code> in <code>finally</code> will mask previous <code>return</code></li> <li>exceptions in <code>finally</code> will mask exceptions previously thrown</li></ul></li> <li>handle exceptions in <code>finally</code> <ul><li>wrap a <code>try catch</code> block to handle possible exception thrown by <code>finally</code><div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">InputStream</span> in <span class="token operator">=</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// code that might throw exceptions</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        <span class="token comment">// in.close();</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// show error message</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li>rethrow the original, suppress exception thrown by <code>finally</code><div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">InputStream</span> in <span class="token operator">=</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">;</span>
<span class="token class-name">Exception</span> ex <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// code that might throw exceptions</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ex <span class="token operator">=</span> e<span class="token punctuation">;</span>
        <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
     <span class="token keyword">try</span> <span class="token punctuation">{</span>
         in<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>ex <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
         <span class="token keyword">else</span> ex<span class="token punctuation">.</span><span class="token function">addSuppressed</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li></ul></li> <li><p><code>try (resources)</code> — auto close when exiting the block</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">Resource</span> res <span class="token operator">=</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// work with res</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>the resource needs to implement <code>AutoCloseable</code> which has a single method<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">AutoCloseable</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li>multiple resources — use <code>;</code> as delimiter</li> <li>when both <code>try</code> block and <code>AutoCloseable::close</code> throw exception — any exceptions thrown by <code>close</code> methods are suppressed</li> <li>can have <code>catch</code> and <code>finally</code> blocks, but not recommended</li></ul></li></ol> <h3 id="Assertion"><a href="#Assertion" class="header-anchor">#</a> Assertion</h3> <ol><li><p>assert</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">assert</span> condition<span class="token punctuation">;</span>
<span class="token keyword">assert</span> condition <span class="token operator">:</span> expression<span class="token punctuation">;</span>
</code></pre></div><ul><li><code>condition</code> — throw an <code>AssertionError</code> if the assertion fails</li> <li><code>expression</code> — passed to <code>AssertionError::new</code> to produce a message string, using <code>String::valueOf</code> when converting</li> <li>enabling and disabling
<ul><li>disabled — disabled by default, <code>-da</code> or <code>-disableassertions</code> to explicitly disable certain classes</li> <li>enable — by <code>-ea</code> or <code>-enableassertions</code><div class="language-shell extra-class"><pre class="language-shell"><code>java -enableassertions MyApp
java -ea:MyClass -ea:com.mycompany.mylib<span class="token punctuation">..</span>. MyApp <span class="token comment"># for specific classes</span>
</code></pre></div><ul><li>enabling mechanism — when enabled, no recompiling, but the class loader stops stripping out the assertion code</li></ul></li> <li>also for JVM loaded classes — some classes are not loaded by a class loader but directly by the virtual machine, but above switches still work</li> <li>enable for system classes — <code>-enablesystemassertions</code> / <code>-esa</code> for system classes</li></ul></li></ul></li> <li><p>assert use</p> <ul><li>fatal errors — assertion failures are intended to be fatal, unrecoverable errors</li> <li>for development and testing — assertion checks are turned on only during development and testing</li> <li>use for precondition — parameter checking</li> <li>use for documenting assumptions<div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// use comments to document underlying assumptions</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span>
<span class="token keyword">else</span> <span class="token comment">// (i % 3 == 2)</span>
<span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// use assertion instead</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span>
<span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">assert</span> i <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// even better assertion</span>
<span class="token keyword">assert</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span>
<span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li><p><code>AssertionError</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AssertionError</span> <span class="token keyword">extends</span> <span class="token class-name">Error</span>
</code></pre></div></li></ol> <h3 id="Logging"><a href="#Logging" class="header-anchor">#</a> Logging</h3> <p>see <a href="/notes-of-tan/backend/java/javaMisc.html#Logging">Logging</a>.</p> <h2 id="Generics"><a href="#Generics" class="header-anchor">#</a> Generics</h2> <ol><li><p>Generics</p> <ul><li><a href="http://angelikalanger.com/GenericsFAQ/JavaGenericsFAQ.html" target="_blank" rel="noopener noreferrer">further reading<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>diamond syntax</li> <li>raw and typed
<ul><li>typed are subtypes — typed ones are subtypes of the raw one</li> <li>warning when using raw types</li> <li>raw at runtime — types only checked when compiling, all are raw without type at runtime</li></ul></li> <li>differently parameterized, different type — no relationship between <code>Generic&lt;Type_2&gt;</code> and <code>Generic&lt;Type_2&gt;</code>, regardless of the relationship between the type variables</li> <li>at runtime in JVM
<ul><li>erased to bound — type variables are erased and replaced by first bound, or <code>Object</code></li> <li>cast when needed — compiler inserts casts to other bounds when necessary
<ul><li>place the predominant interface at the first one for performance</li></ul></li> <li>bridge methods are synthesized when necessary (when overriding)
<ul><li>override method can have a different signature — due to type erasure of generics or different return type</li> <li>bridge method — the same signature of super type method, calls actual method</li></ul></li></ul></li></ul></li> <li><p>generic syntax</p> <ul><li>name conventions
<ul><li><code>E</code> — for the element type of a collection</li> <li><code>K</code> and <code>V</code> — for key and value types of a table</li> <li><code>T</code> (and the neighboring <code>U</code> and <code>S</code>) — for “any type at all”</li></ul></li> <li>generic class syntax<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">}</span>
</code></pre></div></li> <li>generic methods inside ordinary classes<div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@SafeVarargs</span> <span class="token comment">// to suppress Warning: Possible heap pollution from parameterized vararg type</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">getMiddle</span><span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a<span class="token punctuation">[</span>a<span class="token punctuation">.</span>length <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>call — type parameter before method name, <code>className.&lt;type&gt;method(params)</code> <ul><li>avoid parsing ambiguities in C++ — <code>g(f&lt;a,b&gt;(c))</code></li></ul></li> <li>type inference — type can be inferred from parameters, but can be problematic when multiple super types</li></ul></li> <li>generic bounds — <code>extends</code>, including<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span> <span class="token keyword">extends</span> <span class="token class-name">Comparable</span> <span class="token operator">&amp;</span> <span class="token class-name">Serializable</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">)</span>
</code></pre></div><ul><li>class bound — must be the first one in the bounds list</li> <li>interface bound and class bound — arbitrary number of interfaces, but at most one class</li> <li><code>&amp;</code></li></ul></li> <li>wildcards — <code>?</code> <ul><li><code>?</code> — for a variable of type <code>?</code>, can only assign when left value is <code>Object</code>, or right value is <code>null</code></li> <li><code>? extends SomeType</code> — including; a variable of this type can only be right value<div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Manager</span><span class="token punctuation">&gt;</span></span> managerBuddies <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>ceo<span class="token punctuation">,</span> cfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> wildcardBuddies <span class="token operator">=</span> managerBuddies<span class="token punctuation">;</span> <span class="token comment">// OK</span>
<span class="token class-name">Employee</span> e <span class="token operator">=</span> wildcardBuddies<span class="token punctuation">.</span><span class="token function">getFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// function signature is `? extends Employee getFirst()`, OK</span>
wildcardBuddies<span class="token punctuation">.</span><span class="token function">setFirst</span><span class="token punctuation">(</span>lowlyEmployee<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// function signature is `void setFirst(? extends Employee)`, compile-time error</span>
</code></pre></div></li> <li><code>? super SomeType</code> — including; the contrary of <code>? extends SomeType</code> (left value can only be <code>Object</code>)
<ul><li>example — <code>&lt;T extends Comparable&lt;? super T&gt;&gt;</code>, a rescue when <code>T</code> does not implement <code>Comparable</code> but its super class does</li></ul></li> <li>wildcard capture — when the wildcard represents a single, definite type, it can be captured by type parameter<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">swapHelper</span><span class="token punctuation">(</span><span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">T</span> t <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    p<span class="token punctuation">.</span><span class="token function">setFirst</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">getSecond</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    p<span class="token punctuation">.</span><span class="token function">setSecond</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span><span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">swapHelper</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre></div></li></ul></li></ul></li> <li><p>use generics to make checked exceptions unchecked</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span> <span class="token keyword">extends</span> <span class="token class-name">Throwable</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">throwAs</span><span class="token punctuation">(</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">T</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span> e<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// do work</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// the compiler will believe that t becomes an unchecked exception</span>
    <span class="token class-name">Block</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">RuntimeException</span><span class="token punctuation">&gt;</span></span><span class="token function">throwAs</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// alternatively, see https://stackoverflow.com/questions/31316581/a-peculiar-feature-of-exception-type-inference-in-java-8</span>
    <span class="token comment">// Block.throwAs(t);</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>limits of generics</p> <ul><li>type parameters cannot be primitive types — not compatible with <code>Object</code> when type erased at runtime</li> <li>not in static context — type variables not valid in static context (parameterized types are available)<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">T</span> singleInstance<span class="token punctuation">;</span> <span class="token comment">// Error</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">T</span> <span class="token function">getSingleInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Error</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>singleInstance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token comment">// ... construct new instance of T</span>
        <span class="token keyword">return</span> singleInstance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li>not when <code>throw</code> or <code>catch</code> — cannot throw or catch instances of a generic class</li> <li>not when cast and <code>instanceof</code> — compile warning when cast (<code>(Pair&lt;String&gt;) a</code>), compile error when <code>instanceof</code> (<code>a instanceof Pair&lt;T&gt;</code>)</li> <li>name clash
<ul><li>name clash with methods in <code>Object</code> — error by clash with <code>Object::equals</code> when defining <code>equals(T other)</code></li> <li>error when generic interfaces implemented more than once with different arguments — will be a conflict with the synthesized bridge methods<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token keyword">implements</span> <span class="token class-name">Comparable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Manager</span> <span class="token keyword">extends</span> <span class="token class-name">Employee</span> <span class="token keyword">implements</span> <span class="token class-name">Comparable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Manager</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> <span class="token punctuation">}</span> <span class="token comment">// Error</span>
<span class="token comment">// bridge method for Comparable&lt;X&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">Object</span> other<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">X</span><span class="token punctuation">)</span> other<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li>heap pollution, cannot initialize arrays of parameterized types, but can be declared — error when <code>new Pair&lt;String&gt;[10]</code><div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// legal but not safe workaround, possible heap pollution</span>
<span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> table <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">new</span> <span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// heap pollution</span>
<span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> objArray <span class="token operator">=</span> table<span class="token punctuation">;</span> <span class="token comment">// defined above</span>
objArray<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li>cannot instantiate type variable — error when <code>new T()</code> <ul><li>workaround — provide the constructor using lambda<div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> p <span class="token operator">=</span> <span class="token class-name">Pair</span><span class="token punctuation">.</span><span class="token function">makePair</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token operator">::</span><span class="token keyword">new</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">makePair</span><span class="token punctuation">(</span><span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> constr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>constr<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> constr<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li>workaround — use reflection<div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> p <span class="token operator">=</span> <span class="token class-name">Pair</span><span class="token punctuation">.</span><span class="token function">makePair</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">makePair</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> cl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>cl<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cl<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li>cannot construct generic array — error when <code>new T[n]</code> <ul><li>parameterized vararg type (<code>T...</code>) — against the rule, but can use <code>@SafeVarargs</code> to suppress warning</li> <li>workaround — use <code>Object[]</code><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> elements<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">E</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">E</span><span class="token punctuation">)</span> elements<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token class-name">E</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span> elements<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment">// no cast needed</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li>workaround — use cast from <code>Object[]</code>, type erasure makes the cast undetectable at runtime<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">E</span><span class="token punctuation">[</span><span class="token punctuation">]</span> elements<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> elements <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">E</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>not work when assigning to actual type — <code>ArrayList::toArray</code> either return <code>Object[]</code> or take a <code>T[]</code> parameter to return <code>T[]</code></li></ul></li> <li>workaround — provide constructor or use reflection, see above</li></ul></li></ul></li></ol> <h2 id="Annotations"><a href="#Annotations" class="header-anchor">#</a> Annotations</h2> <ol><li><p>annotations</p> <ul><li>syntax — each annotation is preceded by an <code>@</code> symbol, used like a modifier and is placed before the annotated item without a semicolon
<ul><li>an item can have multiple annotations</li> <li>one annotation can be used multiple times on one item if <code>@Repeatable</code></li></ul></li> <li>annotation interfaces — define annotations, creates actual Java interfaces, implicitly extend <code>Annotation</code><div class="language-java extra-class"><pre class="language-java"><code>modifiers <span class="token annotation punctuation">@interface</span> <span class="token class-name">AnnotationName</span> <span class="token punctuation">{</span>
  type <span class="token function">elementName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  type <span class="token function">elementName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>cannot be extended or implemented explicitly</li> <li>when being processed — tools that process annotations receive objects implementing annotation interfaces, and call methods to retrieve elements</li> <li><code>java.lang.annotation.Annotation</code> — the common interface extended by all annotation types. Note that an interface that manually extends this one does not define an annotation type.<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Annotation</span>
</code></pre></div><ul><li><code>Class&lt;? extends Annotation&gt; annotationType()</code></li></ul></li></ul></li> <li>annotation places
<ul><li>declarations</li> <li>type uses</li></ul></li></ul></li> <li><p>annotation elements</p> <ul><li>elements of annotations — parameters when annotating, all element values must be compile-time constants, correspond to methods of annotation interfaces<div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@AnnotationName</span><span class="token punctuation">(</span>elementName1<span class="token operator">=</span>value1<span class="token punctuation">,</span> elementName2<span class="token operator">=</span>value2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@AnnotationName</span>
<span class="token annotation punctuation">@AnnotationName</span><span class="token punctuation">(</span>valueForSingleElement<span class="token punctuation">)</span>
</code></pre></div><ul><li>marker annotation — annotations no elements need to be specified when annotating</li> <li>single value annotation — only one element called <code>value</code></li></ul></li> <li>annotation element types — non-null, usually <code>&quot;&quot;</code> or <code>Void.class</code> as substitution of <code>null</code> <ul><li>primitive types</li> <li><code>String</code></li> <li><code>Class</code></li> <li><code>Enum</code></li> <li>annotation types, error to introduce circular dependencies<div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Reference</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token annotation punctuation">@Reference</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// an annotation type</span>
<span class="token annotation punctuation">@BugReport</span><span class="token punctuation">(</span>ref<span class="token operator">=</span><span class="token annotation punctuation">@Reference</span><span class="token punctuation">(</span>id<span class="token operator">=</span><span class="token string">&quot;3352627&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token comment">// when annotating</span>
</code></pre></div></li> <li>arrays of the preceding types (flat), enclosed in braces when annotating<div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@BugReport</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> reportedBy<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;Harry&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Carl&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@BugReport</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> reportedBy<span class="token operator">=</span><span class="token string">&quot;Joe&quot;</span><span class="token punctuation">)</span> <span class="token comment">// OK, same as {&quot;Joe&quot;}</span>
</code></pre></div></li></ul></li></ul></li> <li><p>declaration annotations</p> <ul><li>annotation target — implementing classes of <code>AnnotatedElement</code>: <code>Class</code> (also interfaces), <code>Constructor</code>, <code>Executable</code>, <code>Field</code>, <code>Method</code>, <code>Package</code>, <code>Parameter</code>; sub-interface <code>TypeVariable</code> and local variables
<ul><li>package annotations — in <code>package-info.java</code>, can only be processed at the source level<div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * Package-level javadoc
 */</span>
<span class="token annotation punctuation">@GPL</span><span class="token punctuation">(</span>version<span class="token operator">=</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>a<span class="token punctuation">.</span>b</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>gnu<span class="token punctuation">.</span></span>GPL<span class="token punctuation">;</span>
</code></pre></div></li> <li>parameter annotations — explicitly declare <code>this</code> if necessary</li></ul></li> <li>local variable annotations — can only be processed at the source level</li> <li>an annotation can annotate itself</li></ul></li> <li><p>type use (<code>ElementType.TYPE_USE</code>) annotations — annotate types, as sub-interfaces of <code>AnnotatedElement</code></p> <ul><li>type arguments — <code>List&lt;@NonNull String&gt;</code>, <code>List&lt;@Localized ? extends Message&gt;</code>, <code>List&lt;? extends @Localized Message&gt;</code></li> <li>arrays — <code>@NonNull String[][] words</code> (<code>words[i][j]</code> is not <code>null</code>), <code>String @NonNull [][] words</code> (<code>words</code> is not <code>null</code>), <code>String[] @NonNull [] words</code> (<code>words[i]</code> is not <code>null</code>)</li> <li>when inheriting — <code>class Warning extends @Localized Message</code></li> <li>when <code>new</code> — <code>new @Localized String(...)</code></li> <li>casts and <code>instanceof</code> — <code>(@Localized String) text</code>, <code>if (text instanceof @Localized String)</code></li> <li>exception specifications — <code>public String read() throws @Localized IOException</code></li> <li>method references — <code>@Localized Message::getText</code></li> <li>cannot<div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token comment">// ERROR: Cannot annotate class literal</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>@<span class="token class-name">NonNull</span> <span class="token class-name">String</span><span class="token punctuation">;</span> <span class="token comment">// ERROR: Cannot annotate import</span>
</code></pre></div></li></ul></li></ol> <h3 id="Standard-Annotations"><a href="#Standard-Annotations" class="header-anchor">#</a> Standard Annotations</h3> <ol><li><p>for compilation</p> <ul><li><code>@Deprecated</code><div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Documented</span>
 <span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>value<span class="token operator">=</span>RUNTIME<span class="token punctuation">)</span>
 <span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token punctuation">{</span>CONSTRUCTOR<span class="token punctuation">,</span>FIELD<span class="token punctuation">,</span>LOCAL_VARIABLE<span class="token punctuation">,</span>METHOD<span class="token punctuation">,</span>PACKAGE<span class="token punctuation">,</span>PARAMETER<span class="token punctuation">,</span>TYPE<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Deprecated</span>
</code></pre></div></li> <li><code>@SuppressWarnings</code><div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token punctuation">{</span>TYPE<span class="token punctuation">,</span>FIELD<span class="token punctuation">,</span>METHOD<span class="token punctuation">,</span>PARAMETER<span class="token punctuation">,</span>CONSTRUCTOR<span class="token punctuation">,</span>LOCAL_VARIABLE<span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>value<span class="token operator">=</span>SOURCE<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">SuppressWarnings</span>
</code></pre></div><ul><li><code>@SuppressWarnings(&quot;fallthrough&quot;)</code></li></ul></li> <li><code>@Override</code> — error when not overriding but define a new method<div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span>value<span class="token operator">=</span>METHOD<span class="token punctuation">)</span>
 <span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>value<span class="token operator">=</span>SOURCE<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Override</span>
</code></pre></div></li> <li><code>@javax.annotation.Generated</code> — mark source code that has been generated. It can also be used to differentiate user written code from generated code in a single file (in <code>javax.annotation.processing</code> for post JDK 8)<div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Documented</span>
 <span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>value<span class="token operator">=</span>SOURCE<span class="token punctuation">)</span>
 <span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token punctuation">{</span>PACKAGE<span class="token punctuation">,</span>TYPE<span class="token punctuation">,</span>ANNOTATION_TYPE<span class="token punctuation">,</span>METHOD<span class="token punctuation">,</span>CONSTRUCTOR<span class="token punctuation">,</span>FIELD<span class="token punctuation">,</span>LOCAL_VARIABLE<span class="token punctuation">,</span>PARAMETER<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Generated</span>
</code></pre></div></li> <li><code>@FunctionalInterface</code> — error if conditions of functional interfaces not meet<div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Documented</span>
 <span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>value<span class="token operator">=</span>RUNTIME<span class="token punctuation">)</span>
 <span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span>value<span class="token operator">=</span>TYPE<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">FunctionalInterface</span>
</code></pre></div></li> <li><code>@SafeVarargs</code> — assertion that the body of the annotated method or constructor does not perform potentially unsafe operations on its varargs parameter<div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Documented</span>
 <span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>value<span class="token operator">=</span>RUNTIME<span class="token punctuation">)</span>
 <span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token punctuation">{</span>CONSTRUCTOR<span class="token punctuation">,</span>METHOD<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">SafeVarargs</span>
</code></pre></div></li></ul></li> <li><p>meta</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Documented</span>
 <span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>value<span class="token operator">=</span>RUNTIME<span class="token punctuation">)</span>
 <span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span>value<span class="token operator">=</span>ANNOTATION_TYPE<span class="token punctuation">)</span>
</code></pre></div><ul><li><code>@java.lang.annotation.Target</code> — the contexts in which an annotation type is applicable, any declaration except a type parameter declaration if absent
<ul><li><code>ElementType[] value</code></li> <li><code>enum java.lang.annotation.ElementType</code> — <code>ANNOTATION_TYPE</code>, <code>CONSTRUCTOR</code>, <code>FIELD</code>, <code>LOCAL_VARIABLE</code>, <code>METHOD</code>, <code>PACKAGE</code>, <code>PARAMETER</code>, <code>TYPE</code>, <code>TYPE_PARAMETER</code>, <code>TYPE_USE</code> <ul><li><code>TYPE</code> — class, interface (including annotation type), or enum declaration</li></ul></li></ul></li> <li><code>@java.lang.annotation.Retention</code> — how long annotations with the annotated type are to be retained, defaults to <code>RetentionPolicy.CLASS</code> if absent
<ul><li><code>RetentionPolicy value</code></li> <li><code>enum java.lang.annotation.RetentionPolicy</code> <ul><li><code>CLASS</code> — in class files but not the VM</li> <li><code>RUNTIME</code></li> <li><code>SOURCE</code></li></ul></li></ul></li> <li><code>@java.lang.annotation.Documented</code> — indicates that annotations with a type are to be documented by javadoc and similar tools by default</li> <li><code>@java.lang.annotation.Inherited</code> — indicates that an annotation type is automatically inherited, has no effect if the annotated type is used to annotate anything other than a class</li> <li><code>@java.lang.annotation.Repeatable</code> — indicates the annotation type is repeatable, with the containing annotation type to hold repeated annotations<div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Repeatable</span><span class="token punctuation">(</span><span class="token class-name">TestCases</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@interface</span> <span class="token class-name">TestCase</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> <span class="token function">params</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> <span class="token function">expected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token annotation punctuation">@interface</span> <span class="token class-name">TestCases</span> <span class="token punctuation">{</span> <span class="token class-name">TestCase</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre></div><ul><li><code>Class&lt;? extends Annotation&gt; value</code> — a container annotation that holds the repeated annotations in an array</li></ul></li></ul></li> <li><p>for java EE resource managing (deprecated from JDK 9 and removed from JDK 11, available in Maven)</p> <ul><li><code>@javax.annotation.PostConstruct</code> — used on a method that needs to be executed after dependency injection is done<div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Documented</span>
 <span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>value<span class="token operator">=</span>RUNTIME<span class="token punctuation">)</span>
 <span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span>value<span class="token operator">=</span>METHOD<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">PostConstruct</span>
</code></pre></div><ul><li>Only one method can be annotated with this annotation</li> <li>annotated method signature — see javadoc</li></ul></li> <li><code>@javax.annotation.PreDestroy</code> — used on methods as a callback notification to signal that the instance is in the process of being removed by the container<div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Documented</span>
 <span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>value<span class="token operator">=</span>RUNTIME<span class="token punctuation">)</span>
 <span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span>value<span class="token operator">=</span>METHOD<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">PreDestroy</span>
</code></pre></div><ul><li>annotated method requirements — see javadoc</li></ul></li> <li><code>@javax.annotation.Resource</code> — marks a resource that is needed by the application<div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token punctuation">{</span>TYPE<span class="token punctuation">,</span>FIELD<span class="token punctuation">,</span>METHOD<span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>value<span class="token operator">=</span>RUNTIME<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Resource</span>
</code></pre></div><ul><li>example<div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Resource</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;jdbc/mydb&quot;</span><span class="token punctuation">)</span> <span class="token keyword">private</span> <span class="token class-name">DataSource</span> source<span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li><code>@javax.annotation.Resources</code> — multiple resources</li></ul></li></ol> <h3 id="Source-Level-Annotation-Processing"><a href="#Source-Level-Annotation-Processing" class="header-anchor">#</a> Source-Level Annotation Processing</h3> <ol><li><p>CLI</p> <div class="language- extra-class"><pre class="language-text"><code>javac -processor &lt;class1&gt;[,&lt;class2&gt;,&lt;class3&gt;...] sourceFiles
</code></pre></div><ul><li>also other alternatives</li> <li>produce new source files until no more — Each annotation processor is executed in turn and given the annotations in which it expressed an interest. If an annotation processor creates a new source file, the process is repeated. Once a processing round yields no further source files, all source files are compiled.
<ul><li><code>-XprintRounds</code> — show rounds</li> <li>cannot modify source files — use with agents or bytecode engineering tools</li></ul></li></ul></li> <li><p><code>javax.annotation.processing</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@SupportedAnnotationTypes</span><span class="token punctuation">(</span><span class="token string">&quot;com.example.annotations.ToString&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SupportedSourceVersion</span><span class="token punctuation">(</span><span class="token class-name">SourceVersion</span><span class="token punctuation">.</span>RELEASE_8<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ToStringAnnotationProcessor</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractProcessor</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">TypeElement</span><span class="token punctuation">&gt;</span></span> annotations<span class="token punctuation">,</span> <span class="token class-name">RoundEnvironment</span> currentRound<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>javax.annotation.processing.AbstractProcessor</code> — for processors to extend<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">AbstractProcessor</span> <span class="token keyword">extends</span> <span class="token class-name">Object</span>
<span class="token keyword">implements</span> <span class="token class-name">Processor</span>
</code></pre></div></li> <li><code>interface</code> <code>javax.annotation.processing.RoundEnvironment</code></li> <li><code>@javax.annotation.processing.SupportedAnnotationTypes</code></li> <li><code>@javax.annotation.processing.SupportedOptions</code></li> <li><code>@javax.annotation.processing.SupportedSourceVersion</code></li></ul></li> <li><p>language model (AST) — <code>javax.lang.model</code></p> <ul><li><code>javax.lang.model.element.Element</code> — AST nodes</li></ul></li></ol></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/tangentyh/notes-of-tan/edit/master/docs/backend/java/javaBasics.md" target="_blank" rel="noopener noreferrer">Edit This Page On GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/7/2020, 5:37:34 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/notes-of-tan/backend/java/javaUtils.html">
        Java Utils
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><div class="vuepress-eqn"></div><span class="vuepress-eq"></span></div></div>
    <script src="/notes-of-tan/assets/js/app.34e04cb3.js" defer></script><script src="/notes-of-tan/assets/js/2.33f31c9b.js" defer></script><script src="/notes-of-tan/assets/js/22.391b670c.js" defer></script>
  </body>
</html>
